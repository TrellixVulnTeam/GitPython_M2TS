#some of these imports are extraneous and left over from the flask megatutorial 
from flask import render_template, flash, redirect, url_for, request, Flask, jsonify, send_from_directory
from app import app, db, DataWizardTools
from app.models import User, Post
from app.forms import PostForm
from werkzeug.urls import url_parse
from datetime import datetime
import pandas as pd
import os

CheckedForImmigration = ["22-1995577",
                            "22-1981876",
                            "22-1983632",
                            "22-1992559",
                            "21-1975597",
                            "22-1990796",
                            "22-1990837",
                            "22-1983011",
                            "22-1988995",
                            "22-1993573",
                            "22-1990279",
                            "22-1990684",
                            "22-1994706",
                            "22-1992050",
                            "22-1995308",
                            "22-1985579",
                            "22-1977900",
                            "22-1994514",
                            "22-1983435",
                            "22-1995950",
                            "22-1994571",
                            "22-1983294",
                            "22-1989753",
                            "22-1983300",
                            "22-1989232",
                            "22-1997503",
                            "22-1991429",
                            "21-1971642",
                            "22-1986129",
                            "22-1976985",
                            "22-1993963",
                            "21-1975794",
                            "22-1978694",
                            "21-1953178",
                            "22-1983039",
                            "22-1994155",
                            "22-1978702",
                            "22-1988035",
                            "22-1996949",
                            "22-1995988",
                            "22-1980560",
                            "22-1979967",
                            "22-1995078",
                            "22-1992737",
                            "22-1991360",
                            "21-1976561",
                            "22-1994019",
                            "16-0819585",
                            "22-1983760",
                            "22-1984748",
                            "22-1988470",
                            "22-1996280",
                            "22-1980642",
                            "22-1993203",
                            "22-1992841",
                            "22-1995517",
                            "22-1979242",
                            "22-1993590",
                            "21-1976142",
                            "21-1975402",
                            "22-1995051",
                            "22-1991766",
                            "22-1978989",
                            "22-1993319",
                            "22-1983081",
                            "21-1976233",
                            "22-1983024",
                            "22-1990355",
                            "22-1996168",
                            "22-1990803",
                            "22-1996125",
                            "22-1990990",
                            "22-1991111",
                            "22-1984130",
                            "22-1997445",
                            "22-1979065",
                            "22-1997371",
                            "22-1989808",
                            "22-1989836",
                            "22-1991367",
                            "22-1986556",
                            "22-1980117",
                            "22-1987408",
                            "22-1996526",
                            "22-1985626",
                            "22-1995986",
                            "22-1996137",
                            "22-1991411",
                            "22-1990864",
                            "22-1995908",
                            "22-1989684",
                            "22-1987723",
                            "22-1984057",
                            "22-1996171",
                            "22-1996719",
                            "22-1988507",
                            "22-1986427",
                            "22-1988638",
                            "22-1997494",
                            "22-1979530",
                            "22-1995920",
                            "22-1991393",
                            "22-1989511",
                            "22-1989511",
                            "22-1994156",
                            "22-1991713",
                            "22-1993528",
                            "22-1977009",
                            "22-1991659",
                            "22-1989691",
                            "22-1995354",
                            "22-1982190",
                            "22-1993318",
                            "22-1988433",
                            "22-1995138",
                            "22-1995089",
                            "22-1986966",
                            "22-1986977",
                            "21-1975235",
                            "22-1993215",
                            "22-1980414",
                            "21-1971670",
                            "22-1986222",
                            "22-1983162",
                            "22-1984312",
                            "22-1983764",
                            "22-1989068",
                            "22-1986114",
                            "22-1984598",
                            "22-1990431",
                            "22-1989866",
                            "22-1988907",
                            "22-1978733",
                            "21-1974634",
                            "22-1981222",
                            "22-1994020",
                            "22-1997452",
                            "22-1991392",
                            "22-1980534",
                            "22-1979251",
                            "22-1997372",
                            "22-1986747",
                            "22-1993789",
                            "22-1981486",
                            "22-1980699",
                            "22-1978755",
                            "22-1990015",
                            "22-1977422",
                            "22-1981553",
                            "21-1976662",
                            "22-1984199",
                            "22-1979265",
                            "22-1982669",
                            "22-1979276",
                            "22-1992673",
                            "22-1994520",
                            "22-1980662",
                            "21-1951080",
                            "22-1983621",
                            "22-1990282",
                            "22-1982019",
                            "22-1990066",
                            "22-1990675",
                            "22-1988892",
                            "22-1996180",
                            "22-1991033",
                            "22-1987289",
                            "22-1987232",
                            "22-1977736",
                            "22-1988746",
                            "22-1996139",
                            "22-1978582",
                            "22-1987426",
                            "22-1997491",
                            "22-1996223",
                            "22-1996589",
                            "22-1990636",
                            "22-1994291",
                            "22-1986736",
                            "21-1976442",
                            "22-1992246",
                            "22-1977574",
                            "22-1983617",
                            "22-1992383",
                            "22-1979429",
                            "22-1987452",
                            "22-1986687",
                            "22-1989026",
                            "22-1983340",
                            "22-1985140",
                            "22-1988066",
                            "22-1976982",
                            "22-1983413",
                            "22-1978060",
                            "22-1993919",
                            "22-1976873",
                            "22-1987326",
                            "22-1989953",
                            "21-1958843",
                            "22-1984853",
                            "21-1976195",
                            ]

CheckedForOverride = ["22-1980837",
                        "22-1993753",
                        "22-1981876",
                        "22-1986178",
                        "22-1996651",
                        "21-1965770",
                        "22-1990837",
                        "21-1972790",
                        "22-1995543",
                        "22-1981027",
                        "22-1985314",
                        "22-1980033",
                        "22-1979261",
                        "22-1977361",
                        "22-1990454",
                        "21-1957792",
                        "22-1990121",
                        "22-1992920",
                        "22-1989255",
                        "22-1987506",
                        "22-1983924",
                        "19-1902239",
                        "22-1993516",
                        "20-1936822",
                        "21-1971800",
                        "21-1962848",
                        "21-1963093",
                        "21-1962869",
                        "21-1970158",
                        "21-1963062",
                        "19-1896195",
                        "21-1972080",
                        "22-1989262",
                        "22-1992918",
                        "19-1887553",
                        "22-1994706",
                        "22-1986418",
                        "22-1997471",
                        "22-1995308",
                        "22-1997477",
                        "17-0824742",
                        "16-0819591",
                        "16-0819585",
                        "22-1997329",
                        "22-1997323",
                        "22-1981259",
                        "21-1976142",
                        "22-1990113",
                        "22-1988259",
                        "21-1973662",
                        "22-1988467",
                        "22-1983300",
                        "22-1984975",
                        "22-1996282",
                        "22-1987642",
                        "22-1997018",
                        "22-1993847",
                        "21-1958302",
                        "22-1982982",
                        "21-1962586",
                        "17-0824860",
                        "22-1976835",
                        "22-1994225",
                        "22-1996069",
                        "22-1986107",
                        "22-1980694",
                        "22-1986308",
                        "22-1985626",
                        "21-1963893",
                        "21-1963810",
                        "22-1991906",
                        "21-1974946",
                        "18-1881187",
                        "19-1897213",
                        "19-1895105",
                        "19-1909532",
                        "20-1919974",
                        "21-1968776",
                        "21-1972666",
                        "22-1978702",
                        "22-1981553",
                        "22-1988397",
                        "22-1996687",
                        "22-1994172",
                        "22-1987206",
                        "22-1990586",
                        "22-1997226",
                        "22-1992673",
                        "22-1981134",
                        "22-1990726",
                        "22-1978594",
                        "22-1984362",
                        "22-1992666",
                        "22-1987141",
                        "21-1971253",
                        "21-1976245",
                        "21-1970320",
                        "22-1986980",
                        "22-1977718",
                        "22-1989770",
                        "22-1990734",
                        "22-1981433",
                        "22-1981285",
                        "21-1972984",
                        "22-1981907",
                        "21-1970474",
                        "22-1982086",
                        "22-1980968",
                        "22-1982019",
                        "22-1979965",
                        "22-1977961",
                        "22-1981923",
                        "22-1989138",
                        "21-1974953",
                        "21-1974368",
                        "22-1977426",
                        "21-1963572",
                        "21-1973988",
                        "21-1975693",
                        "22-1979386",
                        "21-1967594",
                        "22-1990677",
                        "22-1988892",
                        "22-1996125",
                        "22-1987232",
                        "22-1988746",
                        "22-1978071",
                        "22-1995908",
                        "22-1987426",
                        "22-1978893",
                        "22-1980641",
                        "21-1967920",
                        "22-1984459",
                        "22-1993783",
                        "21-1974363",
                        "22-1988432",
                        "22-1980577",
                        "22-1992246",
                        "22-1993318",
                        "22-1980144",
                        "22-1980983",
                        "19-1904680",
                        "22-1995031",
                        "22-1994527",
                        "22-1995138",
                        "22-1984898",
                        "21-1976633",
                        "22-1990010",
                        "21-1975867",
                        "22-1995089",
                        "22-1979283",
                        "22-1979429",
                        "21-1975810",
                        "22-1987331",
                        "21-1968622",
                        "22-1995469",
                        "22-1997019",
                        "22-1996627",
                        "22-1990959",
                        "22-1986977",
                        "21-1975235",
                        "21-1970169",
                        "18-1881045",
                        "22-1983280",
                        "22-1983764",
                        "20-1921420",
                        "22-1989068",
                        "22-1995154",
                        "21-1967970",
                        "22-1983919",
                        "21-1963698",
                        "22-1987276",
                        "22-1976982",
                        "22-1994451",
                        "22-1984337",
                        "21-1963771",
                        "21-1970116",
                        "21-1974209",
                        "22-1993561",
                        "22-1994070",
                        "21-1974072",
                        "21-1974634",
                        "19-1900462",
                        "20-1920771",
                        "21-1973750",
                        "22-1982683",
                        "22-1996838",
                        "21-1974460",
                        "22-1994020",
                        "22-1987764",
                        "22-1984347",
                        "22-1992298",
                        "21-1973119",
                        "22-1989623",
                        "16-0819643",
                        "22-1978112",
                        "22-1988993",
                        "19-1891942",
                        "22-1990674",
                        "22-1980647",
                        "22-1994904",
                        "22-1986584",
                        "22-1978820",
                        "22-1981538",
                        "22-1987092",
                        "22-1981486",
                        "21-1970132",
                        "16-0819581",
                        "16-0819564",
                        "21-1969371",
                        "22-1987963",
                        "22-1996050",
                        "21-1969554",
                        "22-1989800",
                        "21-1963713", '''second batch'''
                        "22-1991663",
                        "22-1989217",
                        "21-1973898",
                        "22-1993157",
                        "22-1993371",
                        "22-1983632",
                        "22-1978728",
                        "22-1990699",
                        "22-1995837",
                        "22-1981770",
                        "22-1978821",
                        "22-1981475",
                        "22-1977386",
                        "22-1997706",
                        "22-1997022",
                        "22-1997686",
                        "22-1997025",
                        "21-1966691",
                        "22-1976968",
                        "22-1993317",
                        "22-1994714",
                        "21-1966223",
                        "21-1974200",
                        "21-1976703",
                        "22-1990752",
                        "22-1993567",
                        "22-1995023",
                        "22-1997703",
                        "21-1967152",
                        "22-1995002",
                        "22-1990062",
                        "21-1962998",
                        "21-1964544",
                        "22-1984971",
                        "21-1972067",
                        "21-1975631",
                        "22-1996026",
                        "22-1986990",
                        "21-1974122",
                        "22-1978732",
                        "22-1989070",
                        "22-1996532",
                        "21-1971007",
                        "22-1980000",
                        "22-1983006",
                        "22-1984717",
                        "22-1996956",
                        "22-1997734",
                        "22-1985770",
                        "21-1967473",
                        "22-1998222",
                        "22-1989230",
                        "21-1953929",
                        "21-1976178",
                        "22-1988901",
                        "22-1993430",
                        "22-1984534",
                        "22-1980256",
                        "22-1988476",
                        "22-1980253",
                        "22-1979944",
                        "22-1980896",
                        "22-1980955",
                        "21-1963595",
                        "22-1994153",
                        "22-1989062",
                        "22-1978876",
                        "22-1978746",
                        "20-1932619",
                        "22-1981780",
                        "22-1987839",
                        "22-1987950",
                        "22-1990668",
                        "21-1954519",
                        "21-1958781",
                        "22-1978229",
                        "22-1998213",
                        "22-1989489",
                        "21-1963309",
                        "22-1995453",
                        "21-1976671",
                        "21-1975589",
                        "22-1977964",
                        "21-1974525",
                        "21-1974430",
                        "22-1988479",
                        "22-1978066",
                        "21-1970268",
                        "22-1994964",
                        "21-1970721",
                        "22-1988150",
                        "21-1962687",
                        "22-1978586",
                        "22-1990141",
                        "22-1995953",
                        "22-1984941",
                        "21-1964469",
                        "21-1972200",
                        "22-1995664",
                        "22-1991887",
                        "22-1987247",
                        "22-1984097",
                        "22-1985319",
                        "22-1977748",
                        "22-1985134",
                        "22-1988448",
                        "22-1998237",
                        "22-1981446",
                        "21-1976013",
                        "22-1996854",
                        "22-1987868",
                        "22-1991745",
                        "22-1983548",
                        "22-1990321",
                        "22-1978517",
                        "22-1997723",
                        "21-1975425",
                        "22-1980784",
                        "22-1995656",
                        "21-1976202",
                        "22-1995643",
                        "22-1996585",
                        "22-1983626",
                        "22-1996017",
                        "22-1980212",
                        "22-1985308",
                        "22-1988404",
                        "22-1991801",
                        "22-1985005",
                        "22-1994023",
                        "21-1963249",
                        "22-1989644",
                        "22-1982420",
                        "21-1973695",
                        "21-1974467",
                        "22-1986252",
                        "21-1971929",
                        "21-1968303",
                        "22-1976877",
                        "21-1974119",
                        "21-1976737",
                        "22-1995898",
                        "22-1996598",
                        "22-1990607",
                        "22-1982697",
                        "22-1977264",
                        "22-1987756",
                        "22-1983456",
                        "21-1973255",
                        "22-1998221",
                        "22-1985109",
                        "22-1982340",
                        "22-1997820",
                        "22-1997376",
                        "22-1979585",
                        "22-1979463",
                        "22-1995866",
                        "22-1997488",
                        "22-1991973",
                        "22-1998031",
                        "21-1976753",
                        "21-1971550",
                        "20-1935912",
                        "21-1965551",
                        "21-1955283",
                        "22-1982629",
                        "21-1971572",
                        "21-1974625",
                        "22-1986887",
                        "22-1986547",
                        "22-1986817",
                        "22-1987192",
                        "19-1901425",
                        "22-1993254",
                        "21-1970629",
                        "21-1975369",
                        "22-1986729",
                        "22-1987554",
                        "21-1972846",
                        "22-1996559",
                        "22-1981408",
                        "21-1947397",
                        "22-1988002",
                        "22-1997665",
                        "21-1975329",
                        "22-1994472",
                        "22-1991949",
                        "19-1887965",
                        "22-1989901",
                        "22-1977561",
                        "22-1984503",
                        "22-1993585",
                        "22-1990661",
                        "22-1980049",
                        "22-1979676",
                        "22-1993344",
                        "22-1992656",
                        "22-1990332",
                        "22-1995452",
                        "21-1975405",
                        "22-1982739",
                        "21-1970552",
                        "22-1992823",
                        "22-1990293",
                        "21-1964923",
                        "22-1990946",
                        "22-1996141",
                        "22-1989358",
                        "20-1926619",
                        "22-1980556",
                        "20-1939692",
                        "21-1970679",
                        "22-1978776",
                        "22-1995622",
                        "21-1974334",
                        "21-1976182",
                        "22-1994762",
                        "22-1997375",
                        "22-1988609",
                        "22-1977781",
                        "22-1979126",
                        "22-1987223",
                        "22-1995781",
                        "22-1987578",
                        "22-1984509",
                        "22-1987769",
                        "22-1985679",
                        "22-1988188",
                        "22-1987196",
                        "22-1988897",
                        "22-1993271",
                        "22-1984546",
                        "22-1995554",
                        "22-1994835",
                        "22-1995691",
                        "22-1992696",
                        "22-1979337",
                        "22-1989218",
                        "22-1979824",
                        "22-1986686",
                        "22-1997447",
                        "22-1995545",
                        "22-1981195",
                        "21-1976352",
                        "21-1956006",
                        "21-1953868",
                        "21-1961604",
                        "21-1969769",
                        "21-1964549",
                        "22-1979826",
                        "22-1979876",
                        "22-1978736",
                        "22-1983913",
                        "21-1957447",
                        "22-1988522",
                        "22-1992184",
                        "22-1996288",
                        "21-1976190",
                        "21-1969750",
                        "22-1979946",
                        "22-1979681",
                        "22-1982665",
                        "22-1990698",
                        "22-1983672",
                        "22-1989240",
                        "22-1997233",
                        "22-1977983",
                        "22-1980507",
                        "22-1981532",
                        "22-1987830",
                        "22-1985522",
                        "22-1994241",
                        "22-1984665",
                        "22-1996557",
                        "21-1976203",
                        "22-1986105",
                        "22-1997399",
                        "22-1985858",
                        "21-1964166",
                        "21-1976717",
                        "22-1991939",
                        "20-1940864",
                        "22-1994534",
                        "21-1962862",
                        "22-1981731",
                        "22-1979471",
                        "22-1995717",
                        "22-1979127",
                        "22-1979302",
                        "22-1995465",
                        "22-1990050",
                        "22-1989484",
                        "22-1984925",
                        "22-1994078",
                        "22-1982387",
                        "22-1984642",
                        "22-1988599",
                        "22-1983833",
                        "22-1985091",
                        "22-1985537",
                        "22-1985825",
                        "22-1985520",
                        "22-1997601",
                        "21-1963961",
                        "21-1970586",
                        "21-1972932",
                        "21-1959043",
                        "21-1976740",
                        "21-1972930",
                        "22-1986042",
                        "22-1997810",
                        "22-1983142",
                        "22-1997398",
                        "22-1990201",
                        "22-1981758",
                        "21-1967262",
                        "22-1989517",
                        "22-1983622",
                        "21-1963468",
                        "17-1847826",
                        "21-1965849",
                        "22-1996057",
                        "22-1980613",
                        "22-1984294",
                        "22-1982956",
                        "22-1987245",
                        "22-1991922",
                        "22-1982780",
                        "22-1997381",
                        "19-1893406",
                        "21-1966336",
                        "22-1990701",
                        "22-1984924",
                        "22-1980533",
                        "22-1997017",
                        "22-1989284",
                        "21-1976294",
                        "22-1988179",
                        "22-1978043",
                        "22-1982362",
                        "22-1981797",
                        "22-1978758",
                        "22-1991027",
                        "22-1990890",
                        "22-1990546",
                        "22-1997772",
                        "22-1989114",
                        "22-1997527",
                        "22-1997799",
                        "22-1993644",
                        "22-1987792",
                        "21-1972802",
                        "21-1976677",
                        "22-1976992",
                        "21-1949336",
                        "21-1976228",
                        "21-1974576",
                        "22-1977010",
                        "21-1969807",
                        "22-1983747",
                        "21-1976563",
                        "22-1989325",
                        "22-1992198",
                        "21-1963922",
                        "22-1994509",
                        "22-1994504",
                        "22-1979321",
                        "21-1972777",
                        "22-1997802",
                        "21-1961774",
                        "22-1977419",
                        "22-1984609",
                        "22-1980046",
                        "22-1981808",
                        "22-1982350",
                        "22-1978998",
                        "22-1991207",
                        "21-1976215",
                        "20-1937646",
                        "20-1938465",
                        "22-1997261",
                        "22-1983762",
                        "22-1997273",
                        "22-1997593",
                        "22-1994432",
                        "22-1990560",
                        "22-1988357",
                        "22-1996664",
                        "22-1992341",
                        "21-1967918",
                        "22-1977349",
                        "22-1977350",
                        "21-1950431",
                        "19-1888495",
                        "22-1989903",
                        "22-1980558",
                        "22-1980732",
                        "22-1987198",
                        "22-1984142",
                        "22-1978301",
                        "22-1989677",
                        "22-1996181",
                        "22-1994115",
                        "22-1989776",
                        "22-1986948",
                        "22-1990682",
                        "22-1990613",
                        "21-1975023",
                        "22-1997057",
                        "21-1976107",
                        "22-1997808",
                        "22-1985716",
                        "22-1997035",
                        "22-1992205",
                        "21-1970354",
                        "22-1988367",
                        "22-1991234",
                        "22-1988333",
                        "21-1971604",
                        "22-1979191",
                        "22-1979816",
                        "22-1996318",
                        "22-1984218",
                        "22-1979683",
                        "17-0830039",
                        "22-1992307",
                        "22-1986162",
                        "22-1996773",
                        "22-1988607",
                        "22-1978235",
                        "22-1982419",
                        "22-1978244",
                        "22-1979372",
                        "22-1982163",
                        "22-1992775",
                        "22-1995111",
                        "22-1978448",
                        "22-1979842",
                        "22-1979760",
                        "22-1991477",
                        "22-1978505",
                        "22-1984382",
                        "22-1978343",
                        "22-1992299",
                        "22-1994318",
                        "22-1991523",
                        "22-1997504",
                        "22-1994135",
                        "22-1995727",
                        "22-1995824",
                        "22-1987085",
                        "22-1994709",
                        "22-1979671",
                        "22-1991717",
                        "21-1969498",
                        "21-1973412",
                        "21-1963530",
                        "22-1997806",
                        "22-1984302",
                        "21-1973808",
                        "21-1970670",
                        "22-1993141",
                        "22-1980786",
                        "22-1986651",
                        "21-1973391",
                        "22-1983651",
                        "22-1997832",
                        "22-1979679",
                        "22-1989568",
                        "21-1973164",
                        "22-1994838",
                        "21-1965414",
                        "21-1975890",
                        "22-1994576",
                        "22-1991587",
                        "22-1992729",
                        "22-1998012",
                        "22-1994873",
                        "22-1997377",
                        "22-1990839",
                        "21-1970196",
                        "21-1975808",
                        "21-1971299",
                        "22-1989745",
                        "22-1997231",
                        "20-1934751",
                        "21-1964427",
                        "21-1971134",
                        "21-1974616",
                        "22-1979202",
                        "22-1984560",
                        "22-1992234",
                        "22-1993953",
                        "22-1995270",
                        "22-1996941",
                        "22-1997763",
                        "22-1997914",
                        "22-1997914",
                        "22-1979230",
                        "22-1988882",
                        "21-1975700",
                        "22-1989110",
                        "22-1992826",
                        "22-1994821",
                        "22-1985622",
                        "22-1986273",
                        "21-1973718",
                        "22-1986709",
                        "22-1991273",
                        "21-1968470",
                        "22-1996775",
                        "21-1972948",
                        "21-1967904",
                        "21-1976375",
                        "22-1987656",
                        "21-1976523",
                        "22-1996152",
                        "22-1979577",
                        "22-1979583",
                        "21-1975727",
                        "22-1979817",
                        "21-1973857",
                        "22-1983699",
                        "22-1995806",
                        "21-1973361",
                        "22-1995166",
                        "22-1981978",
                        "22-1990516",
                        "22-1993368",
                        "22-1984296",
                        "21-1966495",
                        "22-1995003",
                        "22-1996624",
                        "22-1983760",
                        "20-1926892",
                        "22-1984006",
                        "22-1990045",
                        "19-1887493",
                        "22-1990649",
                        "22-1988252",
                        "22-1990280",
                        "22-1988884",
                        "22-1988160",
                        "22-1988353",
                        "21-1953947",
                        "22-1981924",
                        "22-1990903",
                        "22-1998150",
                        "22-1994771",
                        "22-1998025",
                        "22-1992478",
                        "22-1998114",
                        "22-1996063",
                        "21-1976641",
                        "22-1978169",
                        "21-1971288",
                        "21-1974780",
                        "22-1977398",
                        "22-1980612",
                        "22-1990318",
                        "22-1988608",
                        "21-1965819",
                        "22-1981897",
                        "22-1987965",
                        "22-1989015",
                        "22-1982361",
                        "22-1987061",
                        "22-1991274",
                        "22-1985471",
                        "22-1985474",
                        "22-1979990",
                        "21-1974118",
                        "21-1969614",
                        "22-1990768",
                        "22-1991791",
                        "22-1991769",
                        "22-1992773",
                        "22-1991285",
                        "22-1997380",
                        "22-1980735",
                        "21-1972103",
                        "22-1982951",
                        "22-1993563",
                        "22-1993489",
                        "22-1993566",
                        "22-1979237",
                        "22-1990882",
                        "22-1983408",
                        "22-1977430",
                        "22-1995071",
                        "21-1975486",
                        "22-1978747",
                        "22-1981008",
                        "22-1980149",
                        "22-1997841",
                        "22-1993464",
                        "20-1926100",
                        "22-1987631",
                        "22-1992721",
                        "22-1980403",
                        "22-1994030",
                        "22-1982805",
                        "22-1993781",
                        "22-1996756",
                        "22-1977658",
                        "21-1970516",
                        "22-1995407",
                        "22-1981896",
                        "22-1991336",
                        "22-1981393",
                        "21-1976579",
                        "22-1984104",
                        "22-1977084",
                        "22-1989100",
                        "22-1982351",
                        "22-1996623",
                        "22-1990585",
                        "22-1993454",
                        "22-1987924",
                        "22-1997991",
                        "22-1998164",
                        "22-1979038",
                        "22-1987644",
                        "21-1968145",
                        "22-1991803",
                        "22-1995563",
                        "22-1979315",
                        "22-1984951",
                        "22-1978575",
                        "22-1982984",
                        "22-1982834",
                        "22-1982178",
                        "22-1981202",
                        "22-1991120",
                        "22-1986160",
                        "22-1978655",
                        "22-1978635",
                        "22-1992165",
                        "22-1992171",
                        "22-1992674",
                        "22-1977354",
                        "22-1986581",
                        "22-1997701",
                        "22-1985518",
                        "22-1984970",
                        "22-1976828",
                        "22-1992909",
                        "22-1993536",
                        "22-1980072",
                        "22-1987812",
                        "22-1986582",
                        "22-1986594",
                        "22-1980899",
                        "22-1977731",
                        "22-1987482",
                        "22-1987415",
                        "22-1984997",
                        "22-1994981",
                        "22-1997530",
                        "21-1973533",
                        "21-1973035",
                        "22-1990047",
                        "21-1975734",
                        "21-1948679",
                        "21-1966681",
                        "22-1982502",
                        "22-1982185",
                        "22-1987071",
                        "22-1980866",
                        "22-1986804",
                        "22-1994528",
                        "22-1992519",
                        "21-1974048",
                        "22-1997270",
                        "22-1996641",
                        "21-1968636",
                        "21-1975562",
                        "22-1989282",
                        "22-1990657",
                        "22-1990614",
                        "22-1991216",
                        "22-1985893",
                        "22-1985894",
                        "22-1997026",
                        "20-1933055",
                        "22-1979233",
                        "22-1985472",
                        "22-1987216",
                        "22-1990587",
                        "22-1988358",
                        "22-1983464",
                        "22-1981713",
                        "22-1977262",
                        "21-1974766",
                        "22-1978646",
                        "21-1973005",
                        "22-1982483",
                        "22-1982651",
                        "22-1986853",
                        "21-1975003",
                        "22-1987449",
                        "22-1994500",
                        "21-1971025",
                        "22-1982182",
                        "21-1972889",
                        "21-1970755",
                        "22-1993718",
                        "22-1995106",
                        "18-1871800",
                        "22-1995785",
                        "21-1971484",
                        "22-1976827",
                        "21-1958515",
                        "19-1889651",
                        "21-1972935",
                        "21-1975432",
                        "22-1992961",
                        "22-1989275",
                        "22-1980585",
                        "22-1980620",
                        "22-1988925",
                        "21-1956376",
                        "22-1991848",
                        "21-1953247",
                        "22-1981289",
                        "22-1988612",
                        "22-1981953",
                        "22-1994442",
                        "22-1988694",
                        "22-1993887",
                        "22-1992556",
                        "22-1982892",
                        "22-1995770",
                        "22-1979834",
                        "22-1979972",
                        "22-1991668",
                        "22-1991635",
                        "21-1971390",
                        "21-1971481",
                        "21-1964749",
                        "21-1970969",
                        "21-1966408",
                        "22-1977567",
                        "21-1972398",
                        "22-1987217",
                        "21-1972929",
                        "22-1977883",
                        "21-1971023",
                        "19-1916199",
                        "22-1988254",
                        "22-1981873",
                        "22-1988786",
                        "22-1981138",
                        "21-1975639",
                        "22-1992596",
                        "21-1975037",
                        "22-1988683",
                        "22-1981981",
                        "22-1990178",
                        "22-1983185",
                        "22-1983022",
                        "21-1975280",
                        "22-1981867",
                        "22-1993694",
                        "22-1984597",
                        "22-1993994",
                        "21-1974876",
                        "22-1984476",
                        "22-1991656",
                        "22-1983757",
                        "22-1992608",
                        "22-1984850",
                        "21-1968308",
                        "22-1993230",
                        "21-1965592",
                        "22-1992162",
                        "22-1978209",
                        "22-1992183",
                        "22-1991238",
                        "22-1989365",
                        "22-1993151",
                        "22-1980009",
                        "22-1980073",
                        "21-1962891",
                        "21-1970831",
                        "20-1927854",
                        "22-1980018",
                        "22-1992563",
                        "22-1978042",
                        "21-1974110",
                        "22-1989785",
                        "22-1997927",
                        "22-1993076",
                        "22-1990336",
                        "22-1988269",
                        "22-1995488",
                        "22-1995027",
                        "22-1996054",
                        "22-1996993",
                        "21-1976231",
                        "22-1990867",
                        "21-1973440",
                        "21-1975180",
                        "22-1984217",
                        "22-1978816",
                        "22-1982172",
                        "21-1951631",
                        "22-1995117",
                        "21-1966203",
                        "22-1994279",
                        "21-1974445",
                        "21-1974103",
                        "21-1967840",
                        "20-1936186",
                        "20-1927884",
                        "21-1975403",
                        "22-1982045",
                        "22-1988454",
                        "22-1986676",
                        "22-1996875",
                        "21-1965928",
                        "21-1976551",
                        "21-1974978",
                        "22-1989064",
                        "22-1980638",
                        "22-1980170",
                        "22-1981006",
                        "22-1997030",
                        "21-1972910",
                        "22-1978503",
                        "22-1990456",
                        "21-1974063",
                        "22-1988020",
                        "21-1970213",
                        "22-1998001",
                        "22-1986446",
                        "22-1994036",
                        "21-1949076",
                        "20-1932032",
                        "21-1966834",
                        "22-1981887",
                        "22-1992717",
                        "22-1986593",
                        "22-1996354",
                        "22-1997543",
                        "22-1987343",
                        "22-1994963",
                        "22-1990834",
                        "22-1992251",
                        "22-1978236",
                        "22-1988447",
                        "22-1986081",
                        "22-1977770",
                        "21-1976559",
                        "21-1969237",
                        "22-1978576",
                        "22-1995292",
                        "22-1990169",
                        "22-1979123",
                        "22-1985524",
                        "22-1998233",
                        "21-1972855",
                        "21-1965757",
                        "22-1994034",
                        "22-1989678",
                        "22-1982298",
                        "22-1977438",
                        "16-0802308",
                        "21-1963760",
                        "22-1987667",
                        "22-1980351",
                        "22-1988842",
                        "22-1997912",
                        "21-1966610",
                        "22-1983214",
                        "21-1972687",
                        "21-1976057",
                        "22-1980888",
                        "22-1995611",
                        "22-1978048",
                        "22-1985914",
                        "22-1994272",
                        "22-1991641",
                        "21-1974583",
                        "22-1983803",
                        "22-1997068",
                        "22-1981980",
                        "19-1891472",
                        "22-1989797",
                        "22-1985076",
                        "22-1978748",
                        "21-1966784",
                        "22-1997032",
                        "22-1981868",
                        "22-1982524",
                        "22-1992919",
                        "22-1991617",
                        "21-1969387",
                        "22-1997836",
                        "19-1894333",
                        "22-1982614",
                        "22-1979856",
                        "21-1960109",
                        "20-1918754",
                        "19-1906892",
                        "22-1984778",
                        "22-1994506",
                        "22-1982291",
                        "22-1981675",
                        "21-1948860",
                        "22-1984468",
                        "21-1968990",
                        "21-1974153",
                        "21-1975424",
                        "22-1995011",
                        "22-1995438",
                        "22-1978168",
                        "22-1994246",
                        "22-1988387",
                        "22-1994013",
                        "22-1995852",
                        "22-1995467",
                        "22-1997267",
                        "22-1995829",
                        "22-1980161",
                        "22-1978805",
                        "22-1983627",
                        "22-1988919",
                        "22-1983154",
                        "22-1991620",
                        "22-1994673",
                        "19-1887445",
                        "22-1994240",
                        "22-1995918",
                        "21-1963123",
                        "21-1946120",
                        "22-1979764",
                        "21-1950534",
                        "22-1991489",
                        "22-1993957",
                        "22-1989912",
                        "21-1973168",
                        "22-1995167",
                        "22-1989216",
                        "22-1982691",
                        "22-1988523",
                        "22-1977112",
                        "21-1974994",
                        "17-0823697",
                        "21-1975999",
                        "22-1991085",
                        "22-1990573",
                        "21-1954412",
                        "21-1969819",
                        "21-1964490",
                        "22-1991772",
                        "22-1979523",
                        "22-1989202",
                        "22-1990863",
                        "22-1995039",
                        "22-1995965",
                        "22-1983822",
                        "20-1921081",
                        "21-1976749",
                        "22-1980551",
                        "22-1985604",
                        "22-1990966",
                        "21-1971052",
                        "22-1997511",
                        "22-1989642",
                        "22-1989552",
                        "22-1997036",
                        "22-1989036",
                        "22-1977745",
                        "21-1971353",
                        "22-1982437",
                        "22-1987253",
                        "22-1982071",
                        "22-1995745",
                        "22-1988912",
                        "21-1966627",
                        "21-1964916",
                        "21-1950724",
                        "22-1977291",
                        "22-1995162",
                        "22-1996561",
                        "22-1995544",
                        "22-1989832",
                        "21-1963176",
                        "22-1980259",
                        "22-1978221",
                        "22-1992122",
                        "22-1992369",
                        "21-1974503",
                        "22-1996022",
                        "22-1992921",
                        "22-1978515",
                        "22-1983798",
                        "22-1981400",
                        "22-1986195",
                        "22-1981863",
                        "22-1978030",
                        "22-1983391",
                        "22-1995384",
                        "22-1981977",
                        "21-1975822",
                        "22-1977753",
                        "22-1993991",
                        "22-1986454",
                        "22-1987558",
                        "22-1983777",
                        "22-1988809",
                        "22-1993394",
                        "21-1968650",
                        "21-1976718",
                        "22-1976981",
                        "22-1991832",
                        "22-1980889",
                        "22-1981426",
                        "22-1977100",
                        "22-1991550",
                        "22-1983463",
                        "22-1991481",
                        "22-1978855",
                        "22-1979452",
                        "22-1979941",
                        "22-1989076",
                        "22-1982985",
                        "22-1994269",
                        "22-1983808",
                        "22-1994893", '''third batch'''
                        "22-1991663",
                        "22-1990857",
                        "22-1998864",
                        "22-1999542",
                        "22-1978578",
                        "21-1966744",
                        "22-1998868",
                        "22-1994863",
                        "22-1998812",
                        "22-1998884",
                        "20-1928914",
                        "22-1999418",
                        "22-1992724",
                        "22-1998967",
                        "21-1958624",
                        "22-1998419",
                        "22-1996612",
                        "22-1999914",
                        "22-1999806",
                        "22-1999931",
                        "21-1952723",
                        "20-1945625",
                        "19-1914784",
                        "20-1939537",
                        "20-1936119",
                        "19-1914794",
                        "21-1954069",
                        "22-1991335",
                        "22-1998867",
                        "22-1999415",
                        "22-1998391",
                        "21-1957790",
                        "22-1990637",
                        "22-1976928",
                        "22-1998742",
                        "17-1841265",
                        "21-1966056",
                        "22-1999477",
                        "21-1962040",
                        "22-1999359",
                        "22-1999525",
                        "22-1998518",
                        "22-1999589",
                        "22-1998626",
                        "22-1979135",
                        "22-1998636",
                        "22-1998637",
                        "21-1957515",
                        "20-1938726",
                        "20-1919169",
                        "22-1998522",
                        "20-1943063",
                        "20-1921227",
                        "21-1955925",
                        "19-1897243",
                        "19-1897242",
                        "20-1919039",
                        "19-1910568",
                        "18-1859032",
                        "21-1953309",
                        "22-1998523",
                        "22-1998974",
                        "22-1999799",
                        "22-1999592",
                        "22-1999237",
                        "22-1999602",
                        "22-1998427",
                        "22-1998991",
                        "22-1998384",
                        "22-1999061",
                        "22-1995428",
                        "22-1998817",
                        "22-1998420",
                        "20-1934535",
                        "22-1999515",
                        "18-1857800",
                        "22-1998327",
                        "22-1999193",
                        "19-1900024",
                        "22-1998379",
                        "22-1999225",
                        "22-1998783",
                        "22-1999661",
                        "22-1996157",
                        "22-1998798",
                        "22-1998677",
                        "22-1999705",
                        "21-1951080",
                        "22-1996164",
                        "21-1967997",
                        "22-1999941",
                        "22-1992123",
                        "22-1999549",
                        "22-1999488",
                        "22-1999233",
                        "21-1965167",
                        "22-1999926",
                        "22-1986192",
                        "22-1999410",
                        "22-1999739",
                        "22-1976896",
                        "22-1980686",
                        "22-1998769",
                        "22-1989656",
                        "22-1999231",
                        "22-1984928",
                        "22-1990068",
                        "22-1999135",
                        "20-1936607",
                        "19-1914303",
                        "22-1986556",
                        "22-1996719",
                        "22-1994168",
                        "17-1852316",
                        "22-1999176",
                        "22-1999671",
                        "22-1999876",
                        "18-1880218",
                        "21-1949475",
                        "22-1999856",
                        "20-1924931",
                        "20-1941002",
                        "20-1943714",
                        "22-1999828",
                        "22-1998418",
                        "18-1869514",
                        "18-1879559",
                        "21-1956436",
                        "22-1999115",
                        "22-1998535",
                        "22-1998694",
                        "18-1883441",
                        "22-1978733",
                        "22-1999056",
                        "21-1958618",
                        "22-1998635",
                        "18-1883292",
                        "18-1883274",
                        "19-1912444",
                        "22-1998459",
                        "22-1999642",
                        "22-1998617",
                        "22-1998428",
                        "22-1999048",
                        "22-1999848",
                        "18-1880558",
                        "22-1989380",
                        "22-1990358",
                        "22-1999574",
                        "22-1998488",
                        "22-1998893",
                        "22-1999408",
                        "22-1998502",
                        "22-1999685",
                        "17-1852083",
                        "19-1910165",
                        "22-1998542",
                        "22-1998886",
                        "22-1995900",
                        "22-1999360",
                        "22-1999591",
                                    ]

@app.route("/ALComplianceConsolidater", methods=['GET', 'POST'])
def ALComplianceConsolidater():
    #upload file from computer
    if request.method == 'POST':
        print(request.files['file'])
        f = request.files['file']
        
        #turn the excel file into a dataframe, but skip the top 2 rows if they are blank
        test = pd.read_excel(f)
        test.fillna('',inplace=True)
        if test.iloc[0][0] == '':
            df = pd.read_excel(f,skiprows=2)
        else:
            df = pd.read_excel(f)

        
        #Remove Rows without Case ID values
        df.fillna('',inplace = True)
        df['Matter/Case ID#'] = df.apply(lambda x : DataWizardTools.RemoveNoCaseID(x['Matter/Case ID#']),axis=1)        
        df = df[df['Matter/Case ID#'] != 'No Case ID']
        
        #Checkbox determines if it does lsu or all non-LSU***for editing
        '''if request.form.get('Caseworker'):
            df = df[df['Assigned Branch/CC'] == "Legal Support Unit"]
        elif request.form.get('QLS'):
            df = df[df['Assigned Branch/CC'] == "Queens Legal Services"]
        elif request.form.get('MLS'):
        else:
            df = df'''
        
        #Create Hyperlinks
        df['Hyperlinked CaseID#'] = df.apply(lambda x : DataWizardTools.Hyperlinker(x['Matter/Case ID#']),axis=1)     
        
        #Remove duplicate Case ID #s
        
        #df = df.drop_duplicates(subset='Hyperlinked Case #', keep = 'first')
        
        #This is where all the functions happen:
        
        #Intake Splitter:
        
        IntakeList = [
        "Ikram, Nabah",
        "Suriel, Sal",
        "Rodney, Gabby A",
        "Paz, Alex",
        "Alexis, Jennifer",
        "Yeh, Victoria",
        "Navas, Keyra M",
        "Dong, Sean",
        "Baldova, Maria",
        "Djourab, Atteib",
        "Ortega, Luis",
        "Pierre, Haenley",
        "Espinal, Wendy",
        "Cordero, Natalie D",
        "Agarwala, Shelly",
        
        "Matero, Dante C",
        "Espinal, Wendy"]

        #change name of column for intake worker
        df['Intake Caseworker'] = df['Caseworker Name']
        
        df['LSNYC']= "LSNYC"
        
        def IntakeFilter (IntakePerson):
            if IntakePerson in IntakeList:
                return "On hotline"
            else:
                return "Not on hotline"
                
        df['On Hotline?'] = df.apply(lambda x :IntakeFilter(x['Intake Caseworker']),axis=1) 
        

        
        
        #200 percent of poverty income eligible
        #if percentage of poverty is > 200 AND
        #LSC or CSR = yes***removal unclear
        
        def TwoHundredPercentTester(PovPercent,LSCEligible,CSREligible,ComplianceCheck):
            if PovPercent > 200 and LSCEligible == 'Yes' and ComplianceCheck != "Yes":
                return "Needs Review"
            elif PovPercent >200 and CSREligible == 'Yes' and ComplianceCheck != "Yes":
                return "Needs Review"
            else:
                return ''
        
        df['200% of Poverty Tester'] = df.apply(lambda x : TwoHundredPercentTester(x['Percentage of Poverty'],x['LSC Eligible?'],x['CSR Eligible'],x['Compliance Check 200 Poverty Income Eligible']),axis=1)
        
        
        #125-200 poverty income eligible
        #percentage of poverty is between 125 and 200 AND 
        #Income eligible = no ***keep
        
        def OneTwentyFivePercentTester(PovPercent,IncomeEligible, ComplianceCheck):
            if PovPercent > 125 and PovPercent < 200 and IncomeEligible == 'No' and ComplianceCheck != "Yes":
                return "Needs Review"
            else:
                return ''
        
        df['125-200% of Poverty Tester'] = df.apply(lambda x : OneTwentyFivePercentTester(x['Percentage of Poverty'],x['Income Eligible'],x['Compliance Check 125 to 200 Poverty Income Ineligible']),axis=1)
        
        
        #Citizenship and Immigration Compliance
        #custom for access line
        
        
        def CitImmALTester(CitizenshipStatus, ImmigrationStatus, CaseID):
            if CaseID in CheckedForImmigration:
                return ''
            
            elif CitizenshipStatus == "Non-Citizen":
                if ImmigrationStatus != "Asylee" and ImmigrationStatus != 'Lawful Permanent Resident (LPR)' and ImmigrationStatus != 'Refugee':
                
                    return 'Needs Review'
            else:
                return ''
        
        
        #***anyone that's not a citizen, not asylee, not refugee, not greencard holder
        #"anti-abuse notes" include in another column
        
        #***sort by category of issue instead of caseworker like MLS compliance
            
        df['Citizenship & Immigration Tester'] = df.apply(lambda x : CitImmALTester(x['Citizenship Status'],x['Immigration Status'],x['Matter/Case ID#']),axis=1)
        
        def OverrideTester(OverrideReason,CaseID):
            print(CaseID)
            if CaseID in CheckedForOverride:
                print('override case removed')
                return 'Reviewed by Shelly'
            elif OverrideReason != '':
                return 'Needs Review'
        
        df['Override Tester'] = df.apply(lambda x : OverrideTester(x['Financial Eligibility Override Reason'],x['Matter/Case ID#']),axis = 1)
        
        

        df = df[df['On Hotline?'] != 'Not on hotline']
        
        
        #Putting everything in the right order 
        df = df[['Hyperlinked CaseID#',
        'Assigned Branch/CC',
        'Primary Advocate Name',
        'Client First Name',
        'Client Last Name',
        #'Tester Tester',
        '200% of Poverty Tester',
        '125-200% of Poverty Tester',
        #'No Age for Client Tester',
        'Citizenship & Immigration Tester',
        #'Date Opened',
        #'Case Status',
        'Intake Caseworker',
        'Citizenship Status',
        'Immigration Status',
        'Anti-Abuse Statutes Documentation Note (Notes)',
        'Intake - Did You Provide Legal Advice?',
        'Financial Eligibility Override Reason',
        'Financial Override Advocate',
        'Financial Override Notes (Notes)',
        'Override Tester',
        #'Compliance Check 125 to 200 Poverty Income Ineligible',
        #'Compliance Check 200 Poverty Income Eligible',
        #'Compliance Check Citizenship and Immigration',
        #
        #'Attestation on File?',
        #'Staff Verified Non-Citizenship Documentation',
        #'Did any Staff Meet Client in Person?',
        #'Close Reason',
        #'Date Closed',
        'Percentage of Poverty',
        #'Income Eligible',
        #'DOB Information',
        #'Group'
        ]]
    
        #Choose which data to return
        if request.form.get('Aggregate Data'):
            
            TabSplitValue = df['LSNYC']
            print("Aggregate Data = on")
        else:
            
            
            
            TwoHundredPoverty_df = df[df['200% of Poverty Tester'] == "Needs Review"]
            OneTwentyFivePovertydf = df[df['125-200% of Poverty Tester'] == "Needs Review"]
            Citizenship_df = df[df['Citizenship & Immigration Tester'] == "Needs Review"]
            Override_df = df[df['Override Tester'] == "Needs Review"]
            IntakeAdvice_df = df[df['Intake - Did You Provide Legal Advice?'] == ""]
            
            Override_df = Override_df[['Hyperlinked CaseID#',
            'Assigned Branch/CC',
            'Primary Advocate Name',
            'Client First Name',
            'Client Last Name',
            'Percentage of Poverty',
            'Financial Eligibility Override Reason',
            'Financial Override Notes (Notes)',
            'Intake Caseworker',
            'Financial Override Advocate',
            'Override Tester',
            
            ]]
            
            IntakeAdvice_df = IntakeAdvice_df[['Hyperlinked CaseID#',
            'Assigned Branch/CC',
            'Primary Advocate Name',
            'Client First Name',
            'Client Last Name',
            'Intake Caseworker',
            'Intake - Did You Provide Legal Advice?'
            ]]
                
            problem_type_dictionary = {'200% Poverty': TwoHundredPoverty_df , '125% Poverty': OneTwentyFivePovertydf , 'Citizenship': Citizenship_df , 'Override Reason': Override_df,'Intake Advice':IntakeAdvice_df}
            
            
            
            TabSplitValue = df['Intake Caseworker']
            print("Split by Type of Problem")
                    

        df = df.sort_values(by=['Intake Caseworker'])
        

        #Preparing Excel Document
        #bounce worksheets back to excel
        def save_xls(TabSplit, path):
        
            #global output_filename
            #output_filename = f.filename     
            writer = pd.ExcelWriter(path, engine = 'xlsxwriter')
            
            #Create dictionary of tabs, each named after each unique value of 'Intake Case Worker'
            tab_dict_df = problem_type_dictionary
            
            #creates for loop revolving around the split value, ICW or LSNYC(no split)
            
            for splitval in tab_dict_df:
            
                #writes document to excel
                tab_dict_df[splitval].to_excel(writer, splitval, index = False)
                
                #creates ability to format tabs
                worksheet = writer.sheets[splitval]
                workbook = writer.book
                worksheet.freeze_panes(1, 2) 
                
                #create format that will make case #s look like links
                link_format = workbook.add_format({'font_color':'blue', 'bold':True, 'underline':True})
                problem_format = workbook.add_format({'bg_color':'yellow'})
                worksheet.autofilter('A1:Z1')
                B2KFullRange='B2:K'+str(tab_dict_df[splitval].shape[0]+1) 
                print("BAHRowRange is "+ str(B2KFullRange)) 
                
                for column in df:
                    column_width = max(df[column].astype(str).map(len).max(), len(column))
                    #print("I am column width" + str(column_width))
                    col_idx = df.columns.get_loc(column)
                    #print("I am col idx" + str(col_idx))
                    writer.sheets[splitval].set_column(col_idx, col_idx, column_width)
                
                #assign new format to column A
                worksheet.set_column('A:A',20,link_format)
                worksheet.set_column('L:L',50)
                worksheet.conditional_format(B2KFullRange,{'type': 'text',
                                                 'criteria': 'containing',
                                                 'value': 'Needs',
                                                 'format': problem_format})
                worksheet.conditional_format('B1:Z1',{'type': 'text',
                                                 'criteria': 'containing',
                                                 'value': 'Tester',
                                                 'format': problem_format})                                                 
            writer.save()
        
        save_xls(TabSplit = TabSplitValue, path = "app\\sheets\\" + f.filename)
        return send_from_directory('sheets',f.filename, as_attachment = True, attachment_filename = "Access Line " + f.filename) 
        
        '''#send file back to user
        return send_from_directory('sheets',output_filename, as_attachment = True, attachment_filename = "Hyperlinked " + f.filename)'''
        
        #***#
       
        
#what the user-facing site looks like
    return '''
    <!doctype html>
    <title>Access Line Compliance Consolidater</title>
    <link rel="stylesheet" href="/static/css/main.css">  
    <link rel="stylesheet" href="/static/css/main.css"> 
    <h1>Summary of Access Line Compliance Reports</h1>
    <form action="" method=post enctype=multipart/form-data>
    <p><input type=file name=file><input type=submit value=Comply!!>
    
    </br>
        
    <input type="checkbox" id="Aggregate Data" name="Aggregate Data" value="Aggregate Data">
    <label for="Aggregate Data"> Aggregate Data</label><br>
    
    </form>
    <h3>Instructions:</h3>
    <ul type="disc">
    <li>This tool is meant to be used in conjunction with the LegalServer report called <a href="https://lsnyc.legalserver.org/report/dynamic?load=2305" target="_blank">Compliance Consolidated Report</a>.</li>
    <li>This tool defaults to plitting by Intake Caseworker  last updated 05/2022.</li>
    <li>The Aggregate data button will not split the data.</li>
    
    </ul>
    </br>
    <a href="/">Home</a>
    '''
    
