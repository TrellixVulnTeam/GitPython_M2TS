from flask import render_template, flash, redirect, url_for, request, Flask, jsonify, send_from_directory
from app import app, db
from app.models import User, Post
from app.forms import PostForm
from werkzeug.urls import url_parse
from datetime import datetime
import pandas as pd

#list of previously reported cases for 'substantial activity' question
ReportedFY19= [
                    "All Cases Reported FY19",
                    "18-1869227",
                    "19-1889205",
                    "18-1874075",
                    "18-1864086",
                    "18-1863859",
                    "17-1854195",
                    "18-1882612",
                    "18-1882691",
                    "17-1847651",
                    "19-1901913",
                    "18-1880287",
                    "18-1868210",
                    "19-1887412",
                    "19-1901919",
                    "18-1873637",
                    "19-1892462",
                    "18-1866926",
                    "17-1853173",
                    "18-1871015",
                    "18-1863349",
                    "18-1885770",
                    "17-1853299",
                    "18-1883358",
                    "19-1903531",
                    "18-1856367",
                    "18-1875094",
                    "19-1892437",
                    "15-0785039",
                    "18-1881865",
                    "18-1875339",
                    "18-1874331",
                    "18-1881324",
                    "18-1867096",
                    "19-1887521",
                    "18-1862395",
                    "19-1897935",
                    "18-1860518",
                    "19-1896117",
                    "19-1903191",
                    "18-1870239",
                    "19-1896577",
                    "19-1900771",
                    "19-1902931",
                    "17-0832501",
                    "17-1850111",
                    "19-1902818",
                    "17-1837898",
                    "17-1853018",
                    "19-1898663",
                    "18-1860376",
                    "19-1889489",
                    "18-1879685",
                    "18-1874872",
                    "18-1873820",
                    "18-1883932",
                    "18-1881709",
                    "19-1900510",
                    "19-1887632",
                    "18-1869201",
                    "18-1885514",
                    "18-1873466",
                    "19-1902190",
                    "18-1862051",
                    "19-1902209",
                    "19-1902242",
                    "19-1902262",
                    "18-1859480",
                    "18-1880374",
                    "19-1893381",
                    "19-1895373",
                    "15-0771215",
                    "18-1862050",
                    "18-1868972",
                    "18-1863895",
                    "19-1892840",
                    "19-1887188",
                    "18-1880523",
                    "19-1902073",
                    "18-1871999",
                    "18-1869022",
                    "19-1889600",
                    "14-0754603",
                    "18-1865680",
                    "18-1866641",
                    "18-1881276",
                    "18-1866886",
                    "18-1858995",
                    "19-1892209",
                    "19-1897872",
                    "19-1902498",
                    "19-1889636",
                    "18-1882341",
                    "19-1888012",
                    "17-1835752",
                    "18-1885328",
                    "18-1858885",
                    "18-1884160",
                    "19-1895815",
                    "18-1884162",
                    "19-1898170",
                    "18-1884687",
                    "18-1873517",
                    "18-1871819",
                    "19-1888988",
                    "19-1891732",
                    "19-1891828",
                    "19-1901683",
                    "18-1860613",
                    "18-1878549",
                    "19-1901567",
                    "19-1901347",
                    "18-1866277",
                    "18-1883250",
                    "18-1879981",
                    "19-1900873",
                    "18-1877048",
                    "19-1901170",
                    "18-1877701",
                    "18-1865507",
                    "19-1900740",
                    "19-1901798",
                    "18-1873684",
                    "18-1873686",
                    "18-1884897",
                    "18-1870854",
                    "17-0831317",
                    "18-1859179",
                    "19-1888444",
                    "17-1846780",
                    "18-1878977",
                    "18-1870512",
                    "19-1900766",
                    "19-1889888",
                    "17-1846496",
                    "18-1874669",
                    "19-1895366",
                    "19-1900476",
                    "18-1865236",
                    "19-1900214",
                    "18-1871468",
                    "19-1896405",
                    "19-1899925",
                    "18-1885041",
                    "18-1866802",
                    "18-1877339",
                    "18-1877340",
                    "19-1899888",
                    "19-1899569",
                    "19-1899577",
                    "19-1899591",
                    "18-1879946",
                    "19-1903337",
                    "19-1899290",
                    "19-1901734",
                    "19-1887573",
                    "19-1887579",
                    "18-1883009",
                    "18-1883005",
                    "19-1900767",
                    "19-1889938",
                    "18-1874610",
                    "19-1903444",
                    "17-1851132",
                    "19-1891784",
                    "18-1884657",
                    "18-1882124",
                    "18-1865496",
                    "18-1867823",
                    "18-1859199",
                    "18-1874364",
                    "18-1865824",
                    "18-1874404",
                    "15-0775166",
                    "19-1890578",
                    "18-1867405",
                    "18-1863632",
                    "19-1899068",
                    "18-1881412",
                    "18-1874751",
                    "19-1899477",
                    "18-1866547",
                    "18-1868930",
                    "18-1863893",
                    "19-1901895",
                    "19-1898930",
                    "18-1881188",
                    "19-1898949",
                    "18-1882637",
                    "19-1899032",
                    "18-1880381",
                    "18-1874367",
                    "17-1853828",
                    "19-1898913",
                    "19-1898917",
                    "18-1866914",
                    "18-1859782",
                    "17-1842407",
                    "19-1893839",
                    "18-1858257",
                    "18-1876667",
                    "18-1858254",
                    "18-1872410",
                    "17-1851658",
                    "19-1887535",
                    "18-1875135",
                    "18-1879575",
                    "18-1883883",
                    "19-1896961",
                    "18-1881214",
                    "19-1898508",
                    "18-1881639",
                    "19-1888959",
                    "19-1888961",
                    "19-1898430",
                    "18-1869368",
                    "17-0831971",
                    "19-1887159",
                    "18-1886710",
                    "18-1884647",
                    "19-1896180",
                    "18-1878538",
                    "19-1898085",
                    "19-1898075",
                    "18-1861464",
                    "19-1898131",
                    "18-1877171",
                    "18-1885389",
                    "18-1883699",
                    "17-1839286",
                    "18-1859241",
                    "19-1898162",
                    "19-1899057",
                    "18-1870108",
                    "19-1898183",
                    "19-1891970",
                    "19-1903217",
                    "19-1898012",
                    "19-1898053",
                    "19-1889975",
                    "19-1897856",
                    "19-1897860",
                    "19-1897867",
                    "19-1896965",
                    "19-1903422",
                    "18-1868390",
                    "19-1901591",
                    "19-1895544",
                    "18-1882313",
                    "19-1897233",
                    "18-1864534",
                    "19-1897708",
                    "19-1898498",
                    "19-1896232",
                    "19-1903341",
                    "19-1895655",
                    "19-1898135",
                    "18-1882101",
                    "19-1897680",
                    "19-1897490",
                    "19-1897524",
                    "18-1882103",
                    "19-1897300",
                    "19-1898487",
                    "18-1880376",
                    "19-1903652",
                    "18-1861407",
                    "18-1878967",
                    "19-1897213",
                    "19-1897222",
                    "19-1897242",
                    "19-1897243",
                    "19-1895621",
                    "18-1883292",
                    "19-1896873",
                    "18-1886525",
                    "18-1873144",
                    "19-1895454",
                    "18-1861709",
                    "19-1889452",
                    "19-1894194",
                    "19-1893707",
                    "19-1896610",
                    "19-1896619",
                    "19-1896628",
                    "19-1896645",
                    "19-1896662",
                    "18-1867523",
                    "19-1896521",
                    "19-1896558",
                    "19-1896562",
                    "18-1867486",
                    "19-1896407",
                    "18-1879365",
                    "18-1876425",
                    "18-1864074",
                    "19-1894034",
                    "19-1888415",
                    "19-1889864",
                    "18-1884834",
                    "19-1896195",
                    "19-1893915",
                    "19-1898455",
                    "19-1896458",
                    "19-1896100",
                    "18-1868046",
                    "17-1837504",
                    "18-1884957",
                    "18-1866521",
                    "18-1880912",
                    "19-1895868",
                    "19-1893134",
                    "19-1895884",
                    "19-1889990",
                    "18-1867538",
                    "19-1895911",
                    "19-1895914",
                    "19-1895919",
                    "18-1867206",
                    "17-0824373",
                    "19-1898156",
                    "19-1888283",
                    "19-1897662",
                    "17-1858963",
                    "19-1895617",
                    "19-1895509",
                    "19-1902162",
                    "19-1887666",
                    "18-1872951",
                    "18-1873734",
                    "19-1895659",
                    "19-1895662",
                    "18-1866738",
                    "19-1895546",
                    "19-1890655",
                    "19-1887036",
                    "17-1853845",
                    "19-1903451",
                    "19-1903452",
                    "19-1903448",
                    "18-1857583",
                    "17-1852482",
                    "19-1895302",
                    "19-1888494",
                    "17-1835445",
                    "19-1895360",
                    "19-1888498",
                    "19-1888926",
                    "19-1894762",
                    "19-1887680",
                    "18-1878110",
                    "19-1895389",
                    "19-1899534",
                    "19-1887359",
                    "19-1891657",
                    "16-0813689",
                    "18-1881857",
                    "18-1884773",
                    "18-1878539",
                    "18-1856186",
                    "19-1894459",
                    "19-1902556",
                    "19-1887772",
                    "17-1835521",
                    "18-1868609",
                    "19-1897997",
                    "19-1895105",
                    "19-1886850",
                    "19-1886860",
                    "17-1839087",
                    "18-1874772",
                    "18-1884077",
                    "16-0796005",
                    "19-1894749",
                    "18-1875958",
                    "19-1894776",
                    "18-1859811",
                    "19-1894803",
                    "18-1858214",
                    "18-1858217",
                    "19-1894276",
                    "18-1868339",
                    "18-1866617",
                    "19-1894053",
                    "19-1894474",
                    "19-1894523",
                    "19-1894578",
                    "19-1894601",
                    "18-1879493",
                    "18-1862399",
                    "19-1894328",
                    "17-1854036",
                    "19-1894212",
                    "18-1867553",
                    "19-1893464",
                    "19-1894287",
                    "18-1871019",
                    "17-1850299",
                    "18-1869061",
                    "18-1871881",
                    "19-1894058",
                    "19-1895905",
                    "18-1863874",
                    "18-1861325",
                    "19-1893054",
                    "18-1875035",
                    "18-1877669",
                    "18-1863676",
                    "19-1896165",
                    "19-1893781",
                    "18-1861608",
                    "18-1881223",
                    "18-1884201",
                    "19-1893551",
                    "18-1867358",
                    "19-1893099",
                    "19-1893298",
                    "19-1889271",
                    "19-1889362",
                    "18-1867716",
                    "19-1893459",
                    "18-1872614",
                    "19-1897272",
                    "19-1893466",
                    "19-1900238",
                    "19-1893186",
                    "16-0797890",
                    "19-1893468",
                    "18-1870550",
                    "18-1862393",
                    "18-1884044",
                    "19-1893074",
                    "17-1853948",
                    "18-1879679",
                    "18-1858405",
                    "19-1902576",
                    "19-1891704",
                    "18-1870560",
                    "18-1870557",
                    "19-1902142",
                    "19-1887557",
                    "19-1888175",
                    "18-1874634",
                    "18-1877674",
                    "19-1892647",
                    "19-1892721",
                    "18-1863688",
                    "19-1892518",
                    "19-1892555",
                    "19-1903205",
                    "19-1903285",
                    "19-1892612",
                    "19-1899940",
                    "19-1898501",
                    "18-1886429",
                    "18-1863865",
                    "17-1850788",
                    "19-1892396",
                    "17-1854906",
                    "17-1854907",
                    "18-1862992",
                    "19-1892460",
                    "19-1892225",
                    "17-1851269",
                    "18-1869035",
                    "19-1892216",
                    "18-1863772",
                    "19-1892129",
                    "19-1895876",
                    "19-1892073",
                    "19-1903439",
                    "19-1903443",
                    "19-1892343",
                    "19-1892168",
                    "19-1892009",
                    "19-1891474",
                    "18-1870959",
                    "18-1868814",
                    "19-1891981",
                    "19-1892025",
                    "18-1880170",
                    "18-1867930",
                    "18-1867568",
                    "18-1882305",
                    "19-1897624",
                    "18-1861659",
                    "18-1867119",
                    "18-1883943",
                    "18-1883937",
                    "19-1891668",
                    "19-1891695",
                    "19-1891701",
                    "19-1897735",
                    "19-1899531",
                    "18-1886026",
                    "19-1889375",
                    "18-1861320",
                    "19-1900555",
                    "19-1900539",
                    "18-1863585",
                    "18-1862464",
                    "17-1834245",
                    "19-1891538",
                    "19-1891263",
                    "19-1889433",
                    "17-1854155",
                    "19-1902123",
                    "18-1885417",
                    "17-1848150",
                    "19-1891181",
                    "19-1891187",
                    "18-1861376",
                    "19-1891080",
                    "18-1861380",
                    "19-1891012",
                    "19-1891129",
                    "19-1891130",
                    "19-1890872",
                    "18-1877957",
                    "19-1900292",
                    "19-1891337",
                    "19-1890696",
                    "18-1885428",
                    "19-1886911",
                    "18-1869287",
                    "19-1890385",
                    "19-1899443",
                    "18-1886147",
                    "19-1896424",
                    "19-1896430",
                    "19-1892815",
                    "19-1890224",
                    "19-1898735",
                    "19-1898737",
                    "19-1902566",
                    "19-1902573",
                    "18-1867518",
                    "19-1890089",
                    "19-1890110",
                    "18-1867483",
                    "18-1883635",
                    "19-1890027",
                    "18-1863734",
                    "19-1899378",
                    "19-1892163",
                    "17-1843740",
                    "19-1887091",
                    "18-1860364",
                    "17-0825972",
                    "19-1898660",
                    "18-1872804",
                    "19-1889988",
                    "19-1903181",
                    "19-1890000",
                    "19-1890046",
                    "19-1903182",
                    "19-1902104",
                    "18-1882069",
                    "18-1882074",
                    "19-1900274",
                    "19-1900275",
                    "19-1889711",
                    "18-1857575",
                    "17-1845531",
                    "19-1894293",
                    "18-1860042",
                    "19-1894676",
                    "19-1890085",
                    "18-1884149",
                    "19-1889306",
                    "19-1896737",
                    "17-1844741",
                    "19-1886905",
                    "19-1889157",
                    "19-1889176",
                    "19-1901966",
                    "19-1889019",
                    "19-1889044",
                    "19-1898187",
                    "19-1889110",
                    "18-1885441",
                    "18-1868164",
                    "19-1899089",
                    "19-1888276",
                    "19-1888921",
                    "19-1888954",
                    "18-1878580",
                    "18-1869338",
                    "19-1888963",
                    "18-1878581",
                    "19-1897385",
                    "19-1886997",
                    "19-1887995",
                    "19-1903403",
                    "19-1903302",
                    "19-1888747",
                    "19-1888781",
                    "19-1888533",
                    "19-1894783",
                    "19-1891437",
                    "19-1888437",
                    "18-1885327",
                    "18-1868443",
                    "19-1888453",
                    "19-1888458",
                    "18-1866910",
                    "19-1887060",
                    "19-1888398",
                    "18-1863985",
                    "19-1888508",
                    "19-1891231",
                    "18-1875346",
                    "18-1884496",
                    "17-1849433",
                    "19-1891016",
                    "18-1859534",
                    "14-0763319",
                    "18-1871883",
                    "19-1888387",
                    "17-1848994",
                    "18-1885895",
                    "19-1892513",
                    "19-1888500",
                    "18-1866937",
                    "19-1888505",
                    "18-1859398",
                    "18-1883921",
                    "19-1888254",
                    "18-1879394",
                    "17-1834651",
                    "18-1882335",
                    "18-1885150",
                    "18-1883205",
                    "19-1898137",
                    "19-1888257",
                    "18-1881402",
                    "18-1885191",
                    "17-1853857",
                    "19-1888118",
                    "19-1898833",
                    "19-1887881",
                    "19-1895102",
                    "19-1894167",
                    "17-1853587",
                    "18-1857714",
                    "19-1887807",
                    "18-1877764",
                    "17-1851272",
                    "18-1872591",
                    "18-1858865",
                    "17-1853380",
                    "19-1891672",
                    "19-1888702",
                    "19-1887636",
                    "19-1887644",
                    "19-1887650",
                    "19-1887639",
                    "19-1887553",
                    "19-1894897",
                    "18-1869104",
                    "18-1879618",
                    "19-1903293",
                    "18-1885518",
                    "18-1868639",
                    "18-1885516",
                    "18-1871941",
                    "19-1887619",
                    "19-1895402",
                    "19-1887633",
                    "19-1895345",
                    "19-1895399",
                    "18-1857576",
                    "17-0830466",
                    "19-1890321",
                    "19-1887508",
                    "18-1881159",
                    "19-1890326",
                    "19-1887332",
                    "19-1887588",
                    "19-1887595",
                    "19-1888510",
                    "19-1894298",
                    "19-1887390",
                    "18-1860414",
                    "18-1861614",
                    "19-1887165",
                    "19-1887174",
                    "19-1887203",
                    "18-1860046",
                    "18-1882084",
                    "19-1887134",
                    "19-1887137",
                    "19-1886945",
                    "18-1882087",
                    "19-1902496",
                    "19-1901965",
                    "19-1898181",
                    "19-1886838",
                    "18-1885089",
                    "18-1885101",
                    "19-1901617",
                    "18-1863372",
                    "19-1886913",
                    "18-1869892",
                    "19-1886924",
                    "19-1890873",
                    "18-1878315",
                    "19-1893406",
                    "18-1886556",
                    "18-1886608",
                    "18-1886472",
                    "18-1886509",
                    "18-1868859",
                    "15-0774991",
                    "18-1865866",
                    "18-1865870",
                    "18-1882613",
                    "18-1868741",
                    "18-1867446",
                    "18-1862438",
                    "18-1868736",
                    "18-1886058",
                    "18-1867493",
                    "18-1873185",
                    "18-1886002",
                    "18-1886047",
                    "18-1886041",
                    "18-1885935",
                    "18-1863814",
                    "18-1860734",
                    "19-1892260",
                    "19-1890450",
                    "19-1903180",
                    "19-1892448",
                    "18-1883676",
                    "18-1885855",
                    "18-1884530",
                    "18-1871415",
                    "18-1885759",
                    "18-1869766",
                    "19-1899169",
                    "18-1881742",
                    "18-1885556",
                    "18-1885597",
                    "19-1902451",
                    "18-1867993",
                    "18-1885565",
                    "18-1885609",
                    "18-1880831",
                    "18-1856545",
                    "18-1885658",
                    "18-1882472",
                    "19-1903414",
                    "18-1867507",
                    "19-1903297",
                    "18-1881331",
                    "18-1867477",
                    "18-1885524",
                    "18-1885354",
                    "18-1885360",
                    "17-1851853",
                    "18-1885318",
                    "18-1880348",
                    "18-1886144",
                    "19-1901580",
                    "18-1864935",
                    "18-1867918",
                    "18-1867562",
                    "18-1861530",
                    "18-1878582",
                    "19-1897374",
                    "19-1902122",
                    "17-0826134",
                    "18-1884971",
                    "18-1881020",
                    "18-1885000",
                    "18-1886681",
                    "19-1901710",
                    "19-1901667",
                    "18-1885213",
                    "19-1888966",
                    "18-1858696",
                    "19-1899651",
                    "18-1884820",
                    "18-1864647",
                    "18-1884859",
                    "18-1884703",
                    "18-1874677",
                    "18-1874657",
                    "18-1857471",
                    "17-1851939",
                    "18-1884695",
                    "19-1899319",
                    "18-1886553",
                    "18-1867527",
                    "18-1873723",
                    "18-1879554",
                    "19-1888529",
                    "18-1885143",
                    "18-1884390",
                    "18-1871049",
                    "18-1875839",
                    "18-1884315",
                    "19-1895381",
                    "18-1884217",
                    "18-1884096",
                    "18-1886527",
                    "18-1883890",
                    "18-1869514",
                    "18-1884177",
                    "19-1888622",
                    "18-1883998",
                    "18-1882871",
                    "17-1853862",
                    "17-1853863",
                    "18-1868107",
                    "17-1851617",
                    "18-1884002",
                    "19-1902348",
                    "19-1897288",
                    "18-1858252",
                    "18-1858250",
                    "18-1883801",
                    "15-0777569",
                    "18-1871017",
                    "18-1883840",
                    "18-1883846",
                    "17-1850295",
                    "19-1902066",
                    "19-1893458",
                    "18-1881250",
                    "17-1852477",
                    "15-0781443",
                    "19-1899197",
                    "18-1867373",
                    "19-1891450",
                    "18-1879873",
                    "18-1883599",
                    "18-1862005",
                    "18-1885035",
                    "18-1883274",
                    "18-1883531",
                    "19-1893223",
                    "18-1883108",
                    "18-1883486",
                    "18-1883522",
                    "18-1883406",
                    "18-1873681",
                    "16-0819254",
                    "18-1877220",
                    "19-1897565",
                    "18-1883242",
                    "19-1898152",
                    "18-1883285",
                    "19-1899310",
                    "18-1857328",
                    "19-1899789",
                    "18-1883181",
                    "19-1894732",
                    "18-1857090",
                    "18-1882978",
                    "18-1882985",
                    "19-1900770",
                    "18-1874346",
                    "19-1897607",
                    "19-1897934",
                    "18-1882863",
                    "19-1889114",
                    "17-1847390",
                    "19-1903286",
                    "19-1903290",
                    "19-1899945",
                    "18-1882705",
                    "18-1882645",
                    "18-1882729",
                    "18-1882482",
                    "18-1883836",
                    "18-1884949",
                    "18-1865904",
                    "18-1882683",
                    "17-1853962",
                    "18-1882749",
                    "18-1882537",
                    "19-1901925",
                    "18-1885287",
                    "18-1882460",
                    "18-1882467",
                    "19-1895281",
                    "18-1882479",
                    "18-1882339",
                    "18-1867279",
                    "19-1904320",
                    "19-1904323",
                    "19-1904336",
                    "19-1903405",
                    "18-1882268",
                    "19-1894856",
                    "18-1882147",
                    "18-1882170",
                    "19-1903304",
                    "18-1861652",
                    "18-1867135",
                    "19-1902125",
                    "18-1859083",
                    "18-1881998",
                    "18-1882040",
                    "19-1897215",
                    "17-1837391",
                    "18-1863378",
                    "18-1877098",
                    "18-1881867",
                    "18-1881837",
                    "19-1896838",
                    "19-1888295",
                    "18-1868882",
                    "19-1901668",
                    "17-1835785",
                    "16-0821475",
                    "19-1898723",
                    "19-1892809",
                    "19-1898725",
                    "19-1899423",
                    "17-1846371",
                    "19-1901794",
                    "18-1882109",
                    "18-1882112",
                    "17-1848890",
                    "18-1884433",
                    "18-1881535",
                    "18-1881521",
                    "17-0825985",
                    "18-1878258",
                    "18-1872131",
                    "18-1885954",
                    "18-1882795",
                    "18-1881319",
                    "18-1869573",
                    "18-1861317",
                    "18-1881408",
                    "19-1898603",
                    "19-1896186",
                    "19-1898594",
                    "18-1881202",
                    "18-1878583",
                    "19-1898819",
                    "19-1895426",
                    "19-1890662",
                    "18-1855291",
                    "18-1869363",
                    "18-1879984",
                    "18-1881045",
                    "18-1869365",
                    "18-1881130",
                    "18-1881145",
                    "18-1866507",
                    "18-1865238",
                    "18-1860161",
                    "18-1880969",
                    "18-1880987",
                    "18-1881018",
                    "18-1856037",
                    "18-1880905",
                    "19-1888836",
                    "18-1880830",
                    "18-1880791",
                    "18-1883646",
                    "19-1899512",
                    "18-1883293",
                    "19-1902128",
                    "19-1886813",
                    "18-1870322",
                    "19-1900284",
                    "19-1898651",
                    "18-1879652",
                    "18-1880412",
                    "19-1892105",
                    "19-1887556",
                    "18-1880506",
                    "18-1881038",
                    "18-1880314",
                    "19-1902131",
                    "18-1880279",
                    "19-1898642",
                    "19-1896192",
                    "18-1880357",
                    "19-1898587",
                    "18-1863793",
                    "17-0832847",
                    "18-1880091",
                    "18-1880152",
                    "18-1860914",
                    "18-1880032",
                    "18-1880118",
                    "19-1902577",
                    "19-1902563",
                    "18-1880040",
                    "18-1880063",
                    "19-1902580",
                    "19-1897101",
                    "18-1879940",
                    "19-1892157",
                    "19-1895207",
                    "18-1879840",
                    "18-1879854",
                    "18-1866638",
                    "18-1879885",
                    "17-1844510",
                    "18-1879747",
                    "19-1899076",
                    "18-1879794",
                    "18-1879797",
                    "18-1879798",
                    "18-1869041",
                    "19-1901824",
                    "18-1882794",
                    "19-1890642",
                    "18-1871003",
                    "18-1879656",
                    "19-1898787",
                    "18-1879573",
                    "19-1889584",
                    "18-1879483",
                    "19-1902147",
                    "18-1879499",
                    "19-1886939",
                    "18-1879558",
                    "18-1860150",
                    "18-1869063",
                    "19-1888322",
                    "19-1901647",
                    "18-1879319",
                    "18-1879370",
                    "18-1879373",
                    "18-1879378",
                    "19-1887481",
                    "18-1879429",
                    "18-1879123",
                    "18-1879188",
                    "18-1879249",
                    "18-1879065",
                    "18-1879078",
                    "18-1878944",
                    "18-1870967",
                    "18-1860173",
                    "18-1878889",
                    "19-1889202",
                    "18-1879624",
                    "18-1869623",
                    "17-1845051",
                    "18-1878906",
                    "18-1883835",
                    "18-1871827",
                    "18-1878842",
                    "19-1888226",
                    "18-1870780",
                    "18-1878758",
                    "18-1882862",
                    "18-1878773",
                    "18-1878774",
                    "17-1852559",
                    "19-1894743",
                    "18-1866871",
                    "18-1860861",
                    "18-1867030",
                    "18-1869396",
                    "18-1878711",
                    "17-1844163",
                    "18-1878483",
                    "19-1903383",
                    "18-1879401",
                    "19-1895706",
                    "18-1878547",
                    "18-1877097",
                    "18-1878386",
                    "18-1884305",
                    "18-1869651",
                    "18-1878280",
                    "18-1878093",
                    "19-1888697",
                    "18-1878190",
                    "18-1877110",
                    "18-1878020",
                    "18-1883023",
                    "19-1895400",
                    "18-1877942",
                    "18-1878041",
                    "18-1875639",
                    "18-1883022",
                    "18-1877875",
                    "18-1877886",
                    "19-1895398",
                    "18-1881154",
                    "18-1867960",
                    "18-1878528",
                    "18-1877761",
                    "18-1877765",
                    "18-1869053",
                    "18-1859037",
                    "17-1835248",
                    "19-1899249",
                    "18-1868782",
                    "19-1895656",
                    "19-1895113",
                    "18-1877652",
                    "18-1877710",
                    "18-1877477",
                    "18-1877548",
                    "19-1898122",
                    "18-1877609",
                    "18-1877330",
                    "18-1865800",
                    "18-1870555",
                    "18-1872541",
                    "19-1903188",
                    "18-1877218",
                    "18-1880630",
                    "18-1870554",
                    "18-1880828",
                    "18-1877078",
                    "18-1877038",
                    "19-1901960",
                    "19-1888095",
                    "19-1888101",
                    "19-1903366",
                    "18-1876752",
                    "18-1874676",
                    "18-1881826",
                    "19-1895587",
                    "18-1885784",
                    "18-1885786",
                    "19-1898132",
                    "18-1881828",
                    "18-1876476",
                    "18-1876478",
                    "18-1885785",
                    "18-1885787",
                    "18-1876428",
                    "19-1901805",
                    "19-1901807",
                    "18-1876197",
                    "18-1876213",
                    "18-1876017",
                    "18-1875996",
                    "18-1873556",
                    "18-1875840",
                    "18-1875815",
                    "18-1880010",
                    "19-1902198",
                    "18-1867188",
                    "18-1875589",
                    "18-1875484",
                    "18-1868621",
                    "18-1875365",
                    "16-0821553",
                    "18-1875377",
                    "19-1891724",
                    "18-1884026",
                    "18-1875259",
                    "18-1875282",
                    "18-1867050",
                    "18-1861341",
                    "18-1875164",
                    "18-1875013",
                    "18-1875062",
                    "18-1874984",
                    "18-1875044",
                    "18-1882167",
                    "18-1882168",
                    "18-1863035",
                    "18-1874908",
                    "18-1874928",
                    "19-1895269",
                    "18-1873756",
                    "18-1874786",
                    "18-1874804",
                    "18-1863811",
                    "17-1848182",
                    "18-1874672",
                    "19-1896460",
                    "19-1892933",
                    "18-1874685",
                    "18-1874701",
                    "18-1874607",
                    "19-1897139",
                    "18-1874533",
                    "18-1874559",
                    "19-1892935",
                    "17-1848676",
                    "17-1844898",
                    "18-1860178",
                    "19-1890248",
                    "19-1890244",
                    "18-1880066",
                    "18-1865259",
                    "18-1874268",
                    "18-1865728",
                    "17-1840842",
                    "17-1847948",
                    "18-1871493",
                    "18-1874250",
                    "19-1891200",
                    "18-1874042",
                    "18-1873932",
                    "18-1873921",
                    "18-1873864",
                    "18-1873887",
                    "18-1873904",
                    "18-1873936",
                    "18-1873938",
                    "18-1873941",
                    "18-1873970",
                    "19-1889747",
                    "18-1855605",
                    "18-1879913",
                    "18-1882539",
                    "19-1899326",
                    "17-1842579",
                    "18-1873654",
                    "18-1873593",
                    "18-1863866",
                    "18-1856534",
                    "18-1866643",
                    "18-1860655",
                    "18-1873988",
                    "18-1873499",
                    "18-1873524",
                    "18-1869757",
                    "18-1865929",
                    "18-1872781",
                    "18-1881224",
                    "17-1842744",
                    "18-1873496",
                    "18-1881381",
                    "18-1867674",
                    "18-1874877",
                    "18-1873387",
                    "18-1882371",
                    "18-1876301",
                    "18-1868875",
                    "18-1873176",
                    "19-1892574",
                    "18-1873072",
                    "18-1873104",
                    "19-1892577",
                    "19-1892431",
                    "18-1877672",
                    "18-1873080",
                    "18-1873110",
                    "18-1863683",
                    "19-1889947",
                    "18-1872960",
                    "19-1889961",
                    "19-1889953",
                    "19-1901685",
                    "18-1872704",
                    "18-1868658",
                    "17-1853057",
                    "18-1872689",
                    "19-1891380",
                    "18-1882594",
                    "18-1872750",
                    "18-1872560",
                    "18-1863582",
                    "19-1892119",
                    "19-1890316",
                    "18-1869598",
                    "19-1893030",
                    "18-1869092",
                    "18-1877286",
                    "18-1872105",
                    "19-1901969",
                    "19-1890058",
                    "19-1899432",
                    "18-1871818",
                    "17-1838001",
                    "18-1870438",
                    "18-1871776",
                    "18-1859877",
                    "19-1901528",
                    "18-1885760",
                    "18-1871737",
                    "19-1894622",
                    "18-1880070",
                    "18-1869280",
                    "18-1871648",
                    "18-1861467",
                    "18-1871507",
                    "18-1867546",
                    "18-1871487",
                    "18-1871513",
                    "18-1865601",
                    "18-1871428",
                    "18-1867547",
                    "19-1887607",
                    "18-1871901",
                    "18-1871044",
                    "18-1871055",
                    "18-1870990",
                    "18-1880869",
                    "16-0817419",
                    "18-1870924",
                    "18-1870240",
                    "18-1870882",
                    "19-1904296",
                    "18-1871009",
                    "19-1888162",
                    "19-1895310",
                    "18-1855082",
                    "18-1885237",
                    "18-1884353",
                    "19-1902415",
                    "18-1885996",
                    "18-1885998",
                    "18-1867181",
                    "19-1895378",
                    "18-1881560",
                    "17-1853162",
                    "18-1877812",
                    "18-1870344",
                    "19-1897545",
                    "18-1870347",
                    "18-1870271",
                    "18-1870258",
                    "17-1851360",
                    "17-1851338",
                    "18-1870082",
                    "19-1893690",
                    "18-1870143",
                    "18-1870168",
                    "18-1863882",
                    "18-1869894",
                    "18-1869878",
                    "17-0827997",
                    "18-1869065",
                    "17-1846376",
                    "18-1869547",
                    "18-1879626",
                    "18-1869622",
                    "17-1844136",
                    "18-1882274",
                    "18-1869357",
                    "19-1889033",
                    "19-1900108",
                    "14-0768119",
                    "19-1887383",
                    "17-0824182",
                    "18-1869419",
                    "16-0814467",
                    "17-1841894",
                    "18-1859919",
                    "18-1869218",
                    "18-1869233",
                    "18-1869234",
                    "18-1869261",
                    "17-1854250",
                    "19-1900561",
                    "19-1900575",
                    "18-1869169",
                    "18-1869036",
                    "17-1840274",
                    "18-1867707",
                    "18-1861462",
                    "18-1867709",
                    "18-1868931",
                    "18-1863166",
                    "18-1873490",
                    "17-0830888",
                    "18-1862665",
                    "17-1852062",
                    "18-1858260",
                    "16-0822528",
                    "19-1899093",
                    "18-1869060",
                    "18-1874682",
                    "19-1898715",
                    "19-1892805",
                    "19-1898708",
                    "18-1868807",
                    "18-1868800",
                    "19-1901260",
                    "19-1901263",
                    "18-1868886",
                    "18-1868855",
                    "19-1894325",
                    "18-1868878",
                    "18-1868870",
                    "18-1868771",
                    "18-1868810",
                    "19-1891428",
                    "19-1901810",
                    "18-1884672",
                    "18-1857832",
                    "18-1868708",
                    "18-1868665",
                    "18-1868678",
                    "18-1857828",
                    "18-1868717",
                    "18-1877295",
                    "17-1854223",
                    "18-1878918",
                    "18-1869613",
                    "18-1868513",
                    "18-1861399",
                    "18-1866930",
                    "18-1858859",
                    "15-0777702",
                    "18-1868637",
                    "18-1869901",
                    "18-1868415",
                    "18-1884302",
                    "17-0830359",
                    "19-1902933",
                    "19-1888392",
                    "18-1868318",
                    "19-1894097",
                    "18-1868157",
                    "18-1867772",
                    "19-1887684",
                    "18-1868232",
                    "18-1868266",
                    "19-1901964",
                    "19-1894648",
                    "18-1867502",
                    "18-1868135",
                    "18-1867620",
                    "18-1867455",
                    "19-1898497",
                    "18-1880371",
                    "18-1867866",
                    "19-1900508",
                    "19-1901932",
                    "17-0826532",
                    "18-1863803",
                    "18-1867601",
                    "18-1867678",
                    "17-1849293",
                    "18-1867666",
                    "17-1853837",
                    "18-1867964",
                    "19-1896962",
                    "18-1867521",
                    "18-1883918",
                    "18-1866682",
                    "18-1858398",
                    "19-1893536",
                    "19-1893542",
                    "18-1859334",
                    "18-1859338",
                    "18-1875255",
                    "18-1874896",
                    "19-1903411",
                    "19-1888193",
                    "18-1858248",
                    "18-1858246",
                    "19-1903407",
                    "19-1893461",
                    "18-1867428",
                    "18-1861647",
                    "18-1867108",
                    "19-1897066",
                    "19-1899625",
                    "18-1867360",
                    "19-1895814",
                    "15-0791292",
                    "18-1867450",
                    "19-1891255",
                    "18-1867240",
                    "18-1867342",
                    "19-1893039",
                    "18-1857097",
                    "19-1895362",
                    "18-1867104",
                    "15-0775986",
                    "18-1867133",
                    "18-1879559",
                    "18-1867087",
                    "18-1869044",
                    "18-1867028",
                    "18-1866846",
                    "18-1863804",
                    "18-1865504",
                    "18-1868862",
                    "18-1869050",
                    "18-1854936",
                    "18-1878731",
                    "16-0806971",
                    "18-1866749",
                    "18-1866662",
                    "19-1901629",
                    "19-1887358",
                    "18-1866637",
                    "18-1885617",
                    "18-1885538",
                    "17-1840039",
                    "17-1851073",
                    "19-1895059",
                    "18-1866721",
                    "18-1866781",
                    "18-1866583",
                    "18-1862941",
                    "18-1860963",
                    "18-1866610",
                    "18-1885002",
                    "18-1866626",
                    "18-1866481",
                    "18-1866470",
                    "18-1868720",
                    "18-1866515",
                    "17-1849635",
                    "18-1877925",
                    "18-1866303",
                    "18-1866096",
                    "18-1866095",
                    "18-1865936",
                    "18-1866033",
                    "18-1865888",
                    "18-1865835",
                    "18-1867281",
                    "19-1889880",
                    "18-1880907",
                    "18-1877786",
                    "18-1865738",
                    "18-1864721",
                    "18-1865734",
                    "18-1856851",
                    "18-1865703",
                    "18-1871062",
                    "18-1865747",
                    "18-1865677",
                    "18-1880296",
                    "18-1865406",
                    "18-1865451",
                    "16-0819697",
                    "18-1872477",
                    "18-1862287",
                    "18-1886157",
                    "19-1895083",
                    "18-1865540",
                    "18-1864958",
                    "18-1878330",
                    "19-1892695",
                    "18-1883995",
                    "18-1882173",
                    "19-1891543",
                    "18-1864746",
                    "18-1864798",
                    "18-1864590",
                    "18-1885005",
                    "18-1864693",
                    "18-1866673",
                    "18-1858404",
                    "18-1864499",
                    "19-1888172",
                    "18-1864261",
                    "18-1864265",
                    "18-1864288",
                    "18-1864310",
                    "19-1893670",
                    "18-1873987",
                    "18-1864169",
                    "17-1853381",
                    "15-0780000",
                    "18-1877213",
                    "18-1860680",
                    "18-1864008",
                    "16-0819491",
                    "19-1902897",
                    "19-1902824",
                    "18-1861675",
                    "18-1871891",
                    "19-1891342",
                    "19-1899560",
                    "19-1898195",
                    "19-1898500",
                    "18-1881110",
                    "19-1887816",
                    "19-1887821",
                    "19-1899370",
                    "18-1868479",
                    "18-1863880",
                    "18-1869019",
                    "18-1863888",
                    "17-1843435",
                    "19-1891955",
                    "18-1875267",
                    "18-1863671",
                    "18-1863766",
                    "18-1864027",
                    "18-1862653",
                    "19-1893171",
                    "18-1874923",
                    "18-1863511",
                    "19-1900145",
                    "18-1863550",
                    "18-1863561",
                    "18-1860952",
                    "15-0787748",
                    "19-1891377",
                    "18-1863596",
                    "18-1862390",
                    "19-1898106",
                    "18-1863445",
                    "18-1863446",
                    "18-1863502",
                    "18-1863293",
                    "18-1863343",
                    "19-1894827",
                    "18-1860713",
                    "18-1858482",
                    "19-1895787",
                    "18-1863123",
                    "18-1878818",
                    "18-1878932",
                    "18-1868861",
                    "18-1884980",
                    "18-1862932",
                    "18-1862880",
                    "18-1862913",
                    "19-1894148",
                    "18-1870885",
                    "19-1896459",
                    "18-1862547",
                    "19-1892043",
                    "17-1852481",
                    "19-1891386",
                    "18-1867496",
                    "18-1862507",
                    "18-1883982",
                    "18-1874516",
                    "18-1862360",
                    "18-1862354",
                    "18-1882050",
                    "18-1880452",
                    "18-1869048",
                    "17-1848142",
                    "18-1861618",
                    "19-1902124",
                    "18-1861640",
                    "18-1886763",
                    "18-1862604",
                    "19-1895807",
                    "19-1894105",
                    "18-1881133",
                    "18-1861876",
                    "18-1858565",
                    "18-1877825",
                    "18-1861849",
                    "19-1892925",
                    "19-1892928",
                    "18-1861653",
                    "19-1898671",
                    "18-1861575",
                    "19-1898669",
                    "19-1897937",
                    "19-1889473",
                    "19-1891721",
                    "19-1891722",
                    "19-1889740",
                    "19-1889739",
                    "19-1891768",
                    "18-1874142",
                    "17-1838730",
                    "19-1899356",
                    "17-1850691",
                    "17-1853608",
                    "18-1858909",
                    "18-1862021",
                    "18-1885298",
                    "18-1868185",
                    "18-1863586",
                    "19-1891661",
                    "18-1877532",
                    "18-1860867",
                    "18-1860902",
                    "17-1850617",
                    "18-1860918",
                    "19-1904349",
                    "18-1860754",
                    "18-1860829",
                    "18-1860795",
                    "19-1904352",
                    "18-1860786",
                    "18-1860854",
                    "19-1904353",
                    "18-1860643",
                    "18-1870551",
                    "18-1860663",
                    "17-1850659",
                    "18-1860690",
                    "18-1860481",
                    "19-1904265",
                    "19-1904269",
                    "18-1860721",
                    "18-1860371",
                    "18-1860386",
                    "18-1860338",
                    "19-1904285",
                    "18-1861656",
                    "18-1867139",
                    "18-1860283",
                    "19-1898943",
                    "18-1868755",
                    "19-1891799",
                    "18-1860053",
                    "18-1879095",
                    "18-1857574",
                    "18-1878878",
                    "19-1888143",
                    "18-1859828",
                    "18-1859761",
                    "17-1837882",
                    "19-1888861",
                    "18-1860168",
                    "18-1873407",
                    "18-1859648",
                    "18-1859710",
                    "18-1859543",
                    "19-1886952",
                    "18-1877863",
                    "18-1859441",
                    "17-1835840",
                    "19-1892439",
                    "18-1859346",
                    "19-1894911",
                    "18-1883324",
                    "18-1859271",
                    "18-1859554",
                    "18-1875403",
                    "18-1885296",
                    "18-1867556",
                    "18-1859051",
                    "18-1855257",
                    "18-1859133",
                    "18-1868976",
                    "17-1848026",
                    "18-1857821",
                    "18-1875528",
                    "18-1863871",
                    "17-1834807",
                    "19-1891459",
                    "19-1894816",
                    "19-1900768",
                    "19-1900769",
                    "18-1858753",
                    "19-1889475",
                    "19-1891725",
                    "19-1891726",
                    "19-1898958",
                    "18-1858241",
                    "18-1879766",
                    "18-1877933",
                    "17-1852725",
                    "19-1893850",
                    "19-1888089",
                    "18-1883579",
                    "18-1880581",
                    "18-1858521",
                    "18-1858627",
                    "18-1858372",
                    "18-1861605",
                    "17-1846134",
                    "18-1868597",
                    "18-1858410",
                    "18-1858414",
                    "18-1870593",
                    "18-1858258",
                    "18-1858139",
                    "19-1888151",
                    "18-1857420",
                    "19-1888154",
                    "18-1884817",
                    "19-1889846",
                    "18-1857781",
                    "18-1857853",
                    "18-1857777",
                    "18-1857830",
                    "18-1885629",
                    "18-1857573",
                    "18-1872564",
                    "18-1857633",
                    "18-1857721",
                    "18-1856912",
                    "18-1857541",
                    "18-1880794",
                    "18-1880863",
                    "19-1888504",
                    "18-1880866",
                    "19-1888501",
                    "18-1856933",
                    "18-1885542",
                    "18-1856261",
                    "18-1856264",
                    "18-1856886",
                    "18-1856887",
                    "18-1856963",
                    "18-1856998",
                    "18-1856753",
                    "18-1874967",
                    "18-1856628",
                    "18-1856476",
                    "18-1856469",
                    "18-1861630",
                    "18-1856514",
                    "18-1863361",
                    "18-1863362",
                    "18-1856285",
                    "17-1848964",
                    "18-1856338",
                    "19-1887996",
                    "18-1863514",
                    "18-1856040",
                    "18-1885105",
                    "18-1856077",
                    "18-1855689",
                    "18-1855706",
                    "18-1855500",
                    "18-1855513",
                    "18-1855543",
                    "17-1850175",
                    "18-1855394",
                    "19-1887596",
                    "18-1864990",
                    "18-1855379",
                    "18-1858676",
                    "18-1858684",
                    "18-1876917",
                    "19-1899344",
                    "18-1854957",
                    "18-1882114",
                    "18-1871746",
                    "17-1854678",
                    "19-1903194",
                    "19-1903197",
                    "19-1901053",
                    "17-1854178",
                    "19-1892829",
                    "19-1899212",
                    "17-1853979",
                    "17-1853985",
                    "17-1854006",
                    "17-1854047",
                    "19-1899229",
                    "19-1894158",
                    "18-1862674",
                    "19-1895434",
                    "18-1861887",
                    "19-1901070",
                    "18-1856548",
                    "17-1854042",
                    "17-1853689",
                    "18-1881404",
                    "17-1853558",
                    "17-1853528",
                    "18-1857579",
                    "17-0830460",
                    "18-1868118",
                    "17-1853276",
                    "17-1851618",
                    "18-1871236",
                    "17-1853174",
                    "18-1881999",
                    "17-1853007",
                    "19-1896319",
                    "17-1852484",
                    "18-1882058",
                    "18-1876424",
                    "17-1852483",
                    "17-1852495",
                    "18-1876422",
                    "17-1852459",
                    "17-1852451",
                    "18-1863931",
                    "19-1896775",
                    "19-1887947",
                    "17-1852585",
                    "19-1899205",
                    "17-1852227",
                    "17-1852014",
                    "17-1852061",
                    "19-1899236",
                    "17-1852073",
                    "17-1852005",
                    "19-1889206",
                    "18-1886214",
                    "17-1851855",
                    "18-1886292",
                    "18-1877676",
                    "18-1885968",
                    "17-1851659",
                    "17-1851524",
                    "17-1851452",
                    "19-1888632",
                    "17-1851340",
                    "18-1883754",
                    "18-1883764",
                    "18-1883751",
                    "19-1895072",
                    "17-0827705",
                    "19-1895070",
                    "18-1863171",
                    "18-1856250",
                    "16-0821055",
                    "19-1896918",
                    "17-1850416",
                    "19-1895812",
                    "19-1895217",
                    "19-1899100",
                    "17-1850235",
                    "19-1899105",
                    "17-1850026",
                    "17-1847378",
                    "17-1849685",
                    "18-1878765",
                    "18-1878962",
                    "19-1889976",
                    "17-1849376",
                    "19-1888356",
                    "17-1849171",
                    "19-1890859",
                    "19-1890149",
                    "17-1849046",
                    "18-1877893",
                    "18-1877898",
                    "17-1848725",
                    "17-1848726",
                    "17-1848610",
                    "17-1848446",
                    "17-1848376",
                    "18-1877903",
                    "18-1864811",
                    "17-1843038",
                    "17-1848025",
                    "18-1865036",
                    "17-1848003",
                    "18-1874816",
                    "17-1848049",
                    "17-1847692",
                    "17-1847472",
                    "18-1874808",
                    "17-1847549",
                    "18-1879310",
                    "17-1847503",
                    "17-1846781",
                    "17-1846830",
                    "18-1871662",
                    "17-1846422",
                    "18-1868697",
                    "17-1846389",
                    "18-1863892",
                    "19-1902746",
                    "19-1901730",
                    "17-1846186",
                    "17-1846095",
                    "19-1896943",
                    "18-1863959",
                    "17-1845951",
                    "17-1845877",
                    "17-1845702",
                    "17-1845509",
                    "17-1845558",
                    "17-1845322",
                    "17-1845167",
                    "17-1845086",
                    "17-1845156",
                    "17-1845173",
                    "19-1895743",
                    "17-1852970",
                    "18-1863835",
                    "17-1844486",
                    "17-1844402",
                    "16-0812450",
                    "18-1857989",
                    "16-0821879",
                    "16-0815289",
                    "18-1869058",
                    "18-1867875",
                    "17-1843307",
                    "17-1843218",
                    "17-1843235",
                    "17-1843109",
                    "17-1843141",
                    "18-1863784",
                    "17-1842737",
                    "19-1899396",
                    "18-1877782",
                    "17-1842600",
                    "17-1842631",
                    "17-1842643",
                    "19-1887496",
                    "17-1856260",
                    "17-1842101",
                    "17-1841776",
                    "19-1893227",
                    "17-1841309",
                    "18-1881833",
                    "17-1840689",
                    "17-1839168",
                    "17-1840248",
                    "18-1886528",
                    "17-1839963",
                    "17-1839996",
                    "17-1846135",
                    "18-1868601",
                    "17-1854111",
                    "17-1839620",
                    "17-1839621",
                    "18-1881289",
                    "19-1900743",
                    "17-1838842",
                    "17-1838858",
                    "17-1838717",
                    "19-1888126",
                    "19-1888128",
                    "18-1880022",
                    "18-1883605",
                    "17-1837744",
                    "17-1837667",
                    "18-1883611",
                    "17-1837539",
                    "19-1899108",
                    "17-1837358",
                    "17-0831905",
                    "17-1837140",
                    "17-1837006",
                    "17-1836905",
                    "17-1836689",
                    "17-1836339",
                    "17-1836313",
                    "17-1834992",
                    "14-0768129",
                    "19-1902585",
                    "18-1863822",
                    "17-1850246",
                    "17-1835510",
                    "19-1895896",
                    "17-1835315",
                    "18-1880494",
                    "17-1853861",
                    "17-1833321",
                    "17-1849088",
                    "18-1873527",
                    "18-1872875",
                    "17-0830473",
                    "17-0831458",
                    "19-1900944",
                    "18-1865874",
                    "17-1852274",
                    "18-1866625",
                    "19-1901959",
                    "17-0829100",
                    "17-0828869",
                    "14-0749345",
                    "18-1885960",
                    "18-1875751",
                    "18-1885869",
                    "18-1876702",
                    "17-0825385",
                    "17-0825325",
                    "17-0824742",
                    "19-1888848",
                    "18-1873397",
                    "16-0823353",
                    "18-1876102",
                    "16-0822545",
                    "16-0821375",
                    "19-1896313",
                    "19-1896317",
                    "18-1883441",
                    "18-1879226",
                    "18-1858230",
                    "18-1858233",
                    "19-1900544",
                    "16-0819558",
                    "16-0819585",
                    "16-0819602",
                    "19-1900535",
                    "18-1866690",
                    "16-0816343",
                    "17-1846559",
                    "19-1888352",
                    "16-0813462",
                    "16-0811496",
                    "18-1868371",
                    "16-0810288",
                    "16-0809706",
                    "16-0808634",
                    "17-1846137",
                    "19-1888354",
                    "19-1886928",
                    "19-1887251",
                    "18-1871302",
                    "15-0790424",
                    "19-1887381",
                    "15-0787488",
                    "18-1873233",
                    "15-0781442",
                    "18-1876717",
                    "15-0780337",
                    "18-1876660",
                    "19-1899330",
                    "15-0775726",
                    "18-1881792",
                    "17-1851854",
                    "18-1881527",
                    "19-1892551",
                    "14-0763592",
                    "18-1873053",
                    "18-1873055",
                    "17-1843524",
                    "17-1843525",
                    
                    ]

@app.route("/IOIimm", methods=['GET', 'POST'])
def upload_IOIimm():
    if request.method == 'POST':
        print(request.files['file'])
        f = request.files['file']
        
        test = pd.read_excel(f)
        
        test.fillna('',inplace=True)
        
        
        #Cleaning
        if test.iloc[0][0] == '':
            data_xls = pd.read_excel(f,skiprows=2)
        else:
            data_xls = pd.read_excel(f)
        
        data_xls.fillna('',inplace=True)
        last7 = data_xls['Matter/Case ID#'].apply(lambda x: x[3:])
        CaseNum = data_xls['Matter/Case ID#']
        data_xls['Temp Hyperlinked Case #']='=HYPERLINK("https://lsnyc.legalserver.org/matter/dynamic-profile/view/'+last7+'",'+ '"' + CaseNum +'"' +')'
        move=data_xls['Temp Hyperlinked Case #']
        data_xls.insert(0,'Hyperlinked Case #', move)           
        del data_xls['Temp Hyperlinked Case #']
        
        data_xls['Assigned Branch/CC'] = data_xls['Assigned Branch/CC'].str.replace('Bronx Legal Services','BxLS')
        data_xls['Assigned Branch/CC'] = data_xls['Assigned Branch/CC'].str.replace('Brooklyn Legal Services','BkLS')
        data_xls['Assigned Branch/CC'] = data_xls['Assigned Branch/CC'].str.replace('Queens Legal Services','QLS')
        data_xls['Assigned Branch/CC'] = data_xls['Assigned Branch/CC'].str.replace('Manhattan Legal Services','MLS')
        data_xls['Assigned Branch/CC'] = data_xls['Assigned Branch/CC'].str.replace('Staten Island Legal Services','SILS')
        data_xls['Assigned Branch/CC'] = data_xls['Assigned Branch/CC'].str.replace('Legal Support Unit','LSU')
        
        
        
        #Determining 'level of service' from 3 fields       
        def HRA_Service_Level(Close_Reason,LS_LoS):
            Close_Reason = str(Close_Reason)
            LS_LoS = str(LS_LoS)
                
            if Close_Reason.startswith("A") == True:
                return 'Advice'
            elif Close_Reason.startswith("B") == True:
                return 'Brief Service'
            elif Close_Reason.startswith("H") == True or Close_Reason.startswith("I") == True or Close_Reason.startswith("L"):
                return 'Full Rep or Extensive Service'
            elif LS_LoS == 'Advice':
                return 'Advice'
            elif LS_LoS == 'Hold For Review':
                return 'Hold For Review'
            elif LS_LoS == 'Brief Service' or LS_LoS == 'Out-of-Court Advocacy':
                return 'Brief Service'
            elif LS_LoS.startswith('Rep') == True:
                return 'Full Rep or Extensive Service'
            else:
                return ''
        
        data_xls['HRA Level of Service'] = data_xls.apply(lambda x: HRA_Service_Level(x['Close Reason'],x['Level of Service']), axis=1)
        
        
        #Putting Cases into HRA's Baskets!
        def HRA_Case_Coding(LPC,SLPC,HRA_LoS,Crim):
            LPC = str(LPC)
            SLPC = str(SLPC)
            if HRA_LoS == '***Needs Cleanup***':
                return ''
            elif HRA_LoS == 'Hold For Review':
                return 'Hold For Review'
            elif LPC.startswith('2') == True and HRA_LoS == 'Advice':
                return 'B -EMP'
            elif LPC.startswith('2') == True and HRA_LoS == 'Brief Service':
                return 'B -EMP'
            elif SLPC == 'G-639' and HRA_LoS == 'Advice':
                return 'B -INQ'
            elif SLPC == 'G-639' and HRA_LoS == 'Brief Service':
                return 'B -INQ'
            elif SLPC == 'I-914' and HRA_LoS == 'Advice':
                return 'B -CERT'
            elif SLPC == 'I-914' and HRA_LoS == 'Brief Service':
                return 'B -CERT'
            elif SLPC == 'I-918' and HRA_LoS == 'Advice':
                return 'B -CERT'
            elif SLPC == 'I-918' and HRA_LoS == 'Brief Service':
                return 'B -CERT'
            elif HRA_LoS == 'Advice' or HRA_LoS == 'Brief Service':
                return 'B -ADVI'
            elif SLPC == "Emergency Planning":
                return 'B -APD'    
            elif SLPC == "Parental Designation Form":
                return 'B -OTH_Parental Designation Form'
            elif Crim == "Yes":
                return 'T2-REPO_CRIM'    
            elif SLPC == "I-589 Affirmative":
                return 'T2-AR'
            elif SLPC == "I-589 Defensive" or SLPC == "Removal Defense" or SLPC == "EOIR-40" or SLPC == "EOIR-42A"or SLPC == "EOIR-42B" or SLPC == "I-212" or SLPC == "I-485 Defensive":
                return 'T2-RD'
            elif SLPC == "I-912":
                return 'T1-OTH_I-912'
            elif SLPC == "I-130 (spouse)":
                return 'T1-MAR'
            elif SLPC == "I-129F" or SLPC == "I-130" or SLPC == "I-751" or SLPC == "I-864"or SLPC == "I-864EZ" or SLPC == "AOS I-130":
                return 'T1-FAM'
            elif SLPC == "204(L)":
                return 'T2-HO_204(L)'
            elif SLPC == "AR-11":
                return 'T1-OTH_AR-11'    
            elif SLPC == "DS-160" or SLPC == "DS-260":
                return 'T1-CON'
            elif SLPC == "EOIR 27":
                return 'T2-FED'    
            elif SLPC == "EOIR-29 BIA Appeal" or SLPC.startswith("I-290B") == True or SLPC == "N-336":
                return 'T2-APO'
            elif SLPC == "EOIR-26":
                return 'FED'
            elif SLPC == "EOIR-26A":
                return 'T2-REPO_EOIR26a'
            elif SLPC == "EOIR-33/BIA" or SLPC == 'EOIR-33/IC':
                return 'T2-REPO_EOIR33'
            elif SLPC == "G-639":
                return 'T1-OTH_G639'
            elif SLPC == "I-102":
                return 'T1-OTH_I102'
            elif SLPC.startswith("I-131") == True:
                return 'T1-TRV'
            elif SLPC == "I-134":
                return 'T2-REPO_I134'
            elif SLPC == "I-192":
                return 'T2-OTH_I-192'
            elif SLPC == "EOIR-26A":
                return 'T2-REPO_EOIR26a'
            elif SLPC == "I-360 SIJS" or LPC == "44 Minor Guardianship / Conservatorship" or LPC == "42 Neglected/Abused/Dependent":
                return 'T2-SIJS'
            elif SLPC == "I-360 VAWA Self-Petition":
                return 'T2-VAWA'
            elif SLPC == "I-539":
                return 'T1-OTH_I539'
            elif SLPC == "I-601" or SLPC == "I-601A":
                return 'T2-WOI'
            elif SLPC == "I-730":
                return 'T2-AR'
            elif SLPC == "EOIR-26A":
                return 'T2-REPO_EOIR26a'
            elif SLPC == "I-765":
                return 'T1-EAD'
            elif SLPC == "I-821":
                return 'T1-TPS'
            elif SLPC == "I-821D":
                return 'T1-DACA'
            elif SLPC == "I-824":
                return 'T1-OTH_I824'
            elif SLPC == "I-864W":
                return 'T2-VAWA'
            elif SLPC == "I-881":
                return 'T2-HO_I881'
            elif SLPC == "I-90":
                return 'T1-GCR'
            elif SLPC == "I-914" or SLPC == "I-914A":
                return 'T2-HO_I914'
            elif SLPC == "I-918" or SLPC == "I-918A":
                return 'T2-HO_I918'
            elif SLPC == "I-929":
                return 'T2-HO_I929'
            elif SLPC == "I-942":
                return 'T1-OTH_I942'
            elif SLPC == "N-400" or SLPC == "N-565" or SLPC == "N-600" or SLPC == "N-648":
                return 'T1-CIT'
            elif SLPC == "327 Uncontested Divorce":
                return 'T1-SC'
            elif SLPC == "Contested Divorce":
                return 'T2-SC'
            elif SLPC == "340 Name Change":
                return 'T1-OTH_NameChange'
            elif SLPC == "311 Custody":
                return 'T2-FC'
            elif SLPC == 'Legal Rep - Employment Law':
                return 'T1-EMP'
            elif SLPC == 'AOS (Not I-130)' or SLPC == "I-485 Affirmative" :
                return 'T1-AOS'
            else:
                return 'Something is wrong'
    
        data_xls['HRA Case Coding'] = data_xls.apply(lambda x: HRA_Case_Coding(x['Legal Problem Code'],x['Special Legal Problem Code'],x['HRA Level of Service'],x['IOI Does Client Have A Criminal History? (IOI 2)']), axis=1)

        #Dummy SLPC for Juvenile Cases
        def DummySLPC(LPC,SLPC):
            LPC = str(LPC)
            SLPC = str(SLPC)
            if LPC == "44 Minor Guardianship / Conservatorship" or LPC == "42 Neglected/Abused/Dependent":
                return 'N/A'
            else:
                return SLPC
                
        data_xls['Special Legal Problem Code'] = data_xls.apply(lambda x: DummySLPC(x['Legal Problem Code'],x['Special Legal Problem Code']), axis=1)
    
        data_xls['HRA Service Type'] = data_xls['HRA Case Coding'].apply(lambda x: x[:2] if x != 'Hold For Review' else '')

        data_xls['HRA Proceeding Type'] = data_xls['HRA Case Coding'].apply(lambda x: x[3:] if x != 'Hold For Review' else '')
        
        #Giving things better names in cleanup sheet
        
        data_xls['DHCI form?'] = data_xls['Has Declaration of Household Composition and Income (DHCI) Form?']
        
        data_xls['Consent form?'] = data_xls['IOI HRA Consent Form? (IOI 2)']
        
        data_xls['Client Name'] = data_xls['Full Person/Group Name (Last First)']
        
        data_xls['Office'] = data_xls['Assigned Branch/CC']
        
        data_xls['Country of Origin'] = data_xls['IOI Country Of Origin (IOI 1 and 2)']
        
        data_xls['Substantial Activity'] = data_xls['IOI Substantial Activity (Choose One)']
        
        data_xls['Date of Substantial Activity'] = data_xls['Custom IOI Date substantial Activity Performed']
        
        #Income Waiver
        
        def Income_Exclude(IncomePct,Waiver,Referral):   
            IncomePct = int(IncomePct)
            Waiver = str(Waiver)
            if Referral == 'Action NY':
                return ''
            elif IncomePct > 200 and Waiver.startswith('2') == False:
                return 'Needs Income Waiver'
            else:
                return ''

        data_xls['Exclude due to Income?'] = data_xls.apply(lambda x: Income_Exclude(x['Percentage of Poverty'],x['IOI HRA WAIVER APPROVAL DATE if over 200% of FPL (IOI 2)'],x['IOI Referral Source (IOI 2)']), axis=1)
        
        #Eligibility_Date & Rollovers 
        
        def Eligibility_Date(Effective_Date,Date_Opened):
            if Effective_Date != '':
                return Effective_Date
            else:
                return Date_Opened
        data_xls['Eligibility_Date'] = data_xls.apply(lambda x : Eligibility_Date(x['IOI HRA Effective Date (optional) (IOI 2)'],x['Date Opened']), axis = 1)
        
        #Manipulable Dates               
        
        data_xls['Open Month'] = data_xls['Eligibility_Date'].apply(lambda x: str(x)[:2])
        data_xls['Open Day'] = data_xls['Eligibility_Date'].apply(lambda x: str(x)[3:5])
        data_xls['Open Year'] = data_xls['Eligibility_Date'].apply(lambda x: str(x)[6:])
        data_xls['Open Construct'] = data_xls['Open Year'] + data_xls['Open Month'] + data_xls['Open Day']
        
        data_xls['Subs Month'] = data_xls['Date of Substantial Activity'].apply(lambda x: str(x)[:2])
        data_xls['Subs Day'] = data_xls['Date of Substantial Activity'].apply(lambda x: str(x)[3:5])
        data_xls['Subs Year'] = data_xls['Date of Substantial Activity'].apply(lambda x: str(x)[6:])
        data_xls['Subs Construct'] = data_xls['Subs Year'] + data_xls['Subs Month'] + data_xls['Subs Day']
        data_xls['Subs Construct'] = data_xls.apply(lambda x : x['Subs Construct'] if x['Subs Construct'] != '' else 0, axis = 1)
        
        data_xls['Outcome1 Month'] = data_xls['IOI Outcome 2 Date (IOI 2)'].apply(lambda x: str(x)[:2])
        data_xls['Outcome1 Day'] = data_xls['IOI Outcome 2 Date (IOI 2)'].apply(lambda x: str(x)[3:5])
        data_xls['Outcome1 Year'] = data_xls['IOI Outcome 2 Date (IOI 2)'].apply(lambda x: str(x)[6:])
        data_xls['Outcome1 Construct'] = data_xls['Outcome1 Year'] + data_xls['Outcome1 Month'] + data_xls['Outcome1 Day']

        data_xls['Outcome2 Month'] = data_xls['IOI Secondary Outcome Date 2 (IOI 2)'].apply(lambda x: str(x)[:2])
        data_xls['Outcome2 Day'] = data_xls['IOI Secondary Outcome Date 2 (IOI 2)'].apply(lambda x: str(x)[3:5])
        data_xls['Outcome2 Year'] = data_xls['IOI Secondary Outcome Date 2 (IOI 2)'].apply(lambda x: str(x)[6:])
        data_xls['Outcome2 Construct'] = data_xls['Outcome2 Year'] + data_xls['Outcome2 Month'] + data_xls['Outcome2 Day']       
        
        
        #DHCI Form
                
        def DHCI_Needed(DHCI,Open_Construct,LoS):
            if Open_Construct == '':
                return ''
            elif LoS.startswith('Advice'):
                return ''
            elif LoS.startswith('Brief'):
                return ''
            elif int(Open_Construct) < 20180701:
                return ''
            elif DHCI != 'Yes':
                return 'Needs DHCI Form'
            else:
                return ''
        
        data_xls['Needs DHCI?'] = data_xls.apply(lambda x: DHCI_Needed(x['Has Declaration of Household Composition and Income (DHCI) Form?'],x['Open Construct'],x['Level of Service']), axis=1)
        
        
        #Needs Substantial Activity to Rollover into FY'20
        
        def Needs_Rollover(Open_Construct,Substantial_Activity,Substantial_Activity_Date,CaseID,ReportedFY19):
            if int(Open_Construct) >= 20190701:
                return ''
            elif Substantial_Activity != '' and int(Substantial_Activity_Date) >= 20190701 and int(Substantial_Activity_Date) <= 20200630:
                return ''
            elif CaseID in ReportedFY19:
                return 'Needs Substantial Activity in FY20'
            else:
                return ''
                
        data_xls['Needs Substantial Activity?'] = data_xls.apply(lambda x: Needs_Rollover(x['Open Construct'],x['Substantial Activity'],x['Subs Construct'],x['Matter/Case ID#'], ReportedFY19), axis=1)


        #Outcomes
        
                
        #if there are two outcomes choose which outcome to report based on which one happened more recently 
                
        def OutcomeToReport (Outcome1,OutcomeDate1,Outcome2,OutcomeDate2,ServiceLevel,CloseDate):
            if OutcomeDate1 == '' and OutcomeDate2 == '' and CloseDate != '' and ServiceLevel == 'Advice':
                return 'Advice given'
            elif OutcomeDate1 == '' and OutcomeDate2 == '' and CloseDate != '' and ServiceLevel == 'Brief Service':
                return 'Advice given'
            elif CloseDate != '' and ServiceLevel == 'Full Rep or Extensive Service' and Outcome1 == '' and Outcome2 == '':
                return '*Needs Outcome*'
            elif OutcomeDate1 >= OutcomeDate2:
                return Outcome1
            elif OutcomeDate2 > OutcomeDate1:
                return Outcome2
            else:
                return 'no actual outcome'
        
        data_xls['Outcome To Report'] = data_xls.apply(lambda x: OutcomeToReport(x['IOI Outcome 2 (IOI 2)'],x['Outcome1 Construct'],x['IOI Secondary Outcome 2 (IOI 2)'],x['Outcome2 Construct'],x['HRA Level of Service'],x['Date Closed']), axis=1)
      
        #make it add the outcome date as well (or tell you if you need it!)        

        def OutcomeDateToReport (Outcome1,OutcomeDate1,Outcome2,OutcomeDate2,ServiceLevel,CloseDate,ActualOutcomeDate1,ActualOutcomeDate2):
            if OutcomeDate1 == '' and OutcomeDate2 == '' and CloseDate != '' and ServiceLevel == 'Advice':
                return CloseDate
            elif OutcomeDate1 == '' and OutcomeDate2 == '' and CloseDate != '' and ServiceLevel == 'Brief Service':
                return CloseDate           
            elif OutcomeDate1 >= OutcomeDate2:
                return ActualOutcomeDate1
            elif OutcomeDate2 > OutcomeDate1:
                return ActualOutcomeDate2
            else:
                return '*Needs Outcome Date*'
            
                
        data_xls['Outcome Date To Report'] = data_xls.apply(lambda x: OutcomeDateToReport(x['IOI Outcome 2 (IOI 2)'],x['Outcome1 Construct'],x['IOI Secondary Outcome 2 (IOI 2)'],x['Outcome2 Construct'],x['HRA Level of Service'],x['Date Closed'],x['IOI Outcome 2 Date (IOI 2)'],x['IOI Secondary Outcome Date 2 (IOI 2)']), axis=1)
        

        #kind of glitchy - if it has an outcome date but no outcome it doesn't say *Needs Outcome*
               
        
        #Deliverable Categories
        
        def Deliverable_Category(HRA_Coded_Case,Income_Cleanup,Age_at_Intake):
            if Income_Cleanup == 'Needs Income Waiver':
                return 'Needs Cleanup'
            elif HRA_Coded_Case == 'T2-RD' and Age_at_Intake <= 21:
                return 'Tier 2 (minor removal)'
            elif HRA_Coded_Case == 'T2-RD':
                return 'Tier 2 (removal)'
            elif HRA_Coded_Case.startswith('T2') == True:
                return 'Tier 2 (other)'
            elif HRA_Coded_Case.startswith('T1')== True:
                return 'Tier 1'
            elif HRA_Coded_Case.startswith('B') == True:
                return 'Brief'
            else:
                return 'Needs Cleanup'

        data_xls['Deliverable Tally'] = data_xls.apply(lambda x: Deliverable_Category(x['HRA Case Coding'],x['Exclude due to Income?'],x['Age at Intake']), axis=1)
        
        
        #add LSNYC to start of case numbers 
        
        data_xls['Unique_ID'] = 'LSNYC'+data_xls['Matter/Case ID#']
        
        #take second letters of first and last names
        
        data_xls['Last_Initial'] = data_xls['Client Last Name'].str[1]
        data_xls['First_Initial'] = data_xls['Client First Name'].str[1]

        #Year of birth
        data_xls['Year_of_Birth'] = data_xls['Date of Birth'].str[-4:]
        
        #gender
        def HRAGender (gender):
            if gender == 'Male' or gender == 'Female':
                return gender
            else:
                return 'Other'
        data_xls['Gender'] = data_xls.apply(lambda x: HRAGender(x['Gender']), axis=1)
        
        #county=borough
        data_xls['Borough'] = data_xls['County of Residence']
        
        #household size etc.
        data_xls['Household_Size'] = data_xls['Number of People under 18'].astype(int) + data_xls['Number of People 18 and Over'].astype(int)
        data_xls['Number_of_Children'] = data_xls['Number of People under 18']
        
        #Income Eligible?
        data_xls['Annual_Income'] = data_xls['Total Annual Income ']
        def HRAIncElig (PercentOfPoverty):
            if PercentOfPoverty > 200:
                return 'NO'
            else:
                return 'YES'
        data_xls['Income_Eligible'] = data_xls.apply(lambda x: HRAIncElig(x['Percentage of Poverty']), axis=1)
        
        def IncWaiver (eligible,waiverdate):
            if eligible == 'NO' and waiverdate != '':
                return 'Income'
            else:
                return ''
        data_xls['Waiver_Type'] = data_xls.apply(lambda x: IncWaiver(x['Income_Eligible'],x['IOI HRA WAIVER APPROVAL DATE if over 200% of FPL (IOI 2)']), axis=1)
        
        def IncWaiverDate (waivertype,date):
            if waivertype != '':
                return date
            else:  
                return ''
                
        data_xls['Waiver_Approval_Date'] = data_xls.apply(lambda x: IncWaiverDate(x['Waiver_Type'],x['IOI HRA WAIVER APPROVAL DATE if over 200% of FPL (IOI 2)']), axis = 1)
        
        #Referrals
        def Referral (referral):
            if referral == "Action NY":
                return "ActionNYC"
            elif referral == "HRA":
                return "HRA-DSS"
            elif referral == "Other":
                return "Other"
            elif referral == "":
                return "None"
            else:
                return ""
                
        data_xls['Referral_Source'] = data_xls.apply(lambda x: Referral(x['IOI Referral Source (IOI 2)']), axis = 1)
        
        #Pro Bono Involvement
        def ProBonoCase (branch, pai):
            if branch == "LSU" or pai == "Yes":
                return "YES"
            else:
                return "NO"
                
        data_xls['Pro_Bono'] = data_xls.apply(lambda x:ProBonoCase(x['Assigned Branch/CC'], x['PAI Case?']), axis = 1)
        
        #Other Cleanup
        data_xls['Service_Type_Code'] = data_xls['HRA Service Type']
        data_xls['Proceeding_Type_Code'] = data_xls['HRA Proceeding Type']
        data_xls['Outcome'] = data_xls['Outcome To Report']
        data_xls['Outcome_Date'] = data_xls['Outcome Date To Report']
        data_xls['Seized_at_Border'] = data_xls['IOI Was client apprehended at border? (IOI 2&3)']
        data_xls['Group'] = ''
        data_xls['Prior_Enrollment_FY'] = 'Jay does this manually later'
        """
          
        #CLEANUP VERSION Put everything in the right order
        data_xls = data_xls[['Hyperlinked Case #','Office','Primary Advocate','Client Name','Special Legal Problem Code','Level of Service','Needs DHCI?','Exclude due to Income?','Needs Substantial Activity?','Country of Origin','Language','Outcome To Report','HRA Case Coding','IOI Was client apprehended at border? (IOI 2&3)']]
        
        """
        #REPORTING VERSION Put everything in the right order
        data_xls = data_xls[['Unique_ID','Last_Initial','First_Initial','Year_of_Birth','Gender','Country of Origin','Borough','Zip Code','Language','Household_Size','Number_of_Children','Annual_Income','Income_Eligible','Waiver_Type','Waiver_Approval_Date','Eligibility_Date','Referral_Source','Service_Type_Code','Proceeding_Type_Code','Outcome','Outcome_Date','Seized_at_Border','Group','Prior_Enrollment_FY','Pro_Bono','Special Legal Problem Code','HRA Level of Service','HRA Case Coding','Hyperlinked Case #','Office','Primary Advocate','Client Name','Special Legal Problem Code','Level of Service','Needs DHCI?','Exclude due to Income?','Needs Substantial Activity?','Country of Origin','Outcome To Report','HRA Case Coding','IOI Was client apprehended at border? (IOI 2&3)']]
        
        #substantial activities filter - need to totally review what makes a case non-reportable, get rid of stacking cap, income, dhci form, no service entries... that's it? etc.
        
        
        #Preparing Excel Document
        
        output_filename = f.filename     
        writer = pd.ExcelWriter("app\\sheets\\"+output_filename, engine = 'xlsxwriter')
        data_xls.to_excel(writer, sheet_name='Sheet1',index=False)

        workbook = writer.book
        worksheet = writer.sheets['Sheet1']

        link_format = workbook.add_format({'font_color':'blue', 'bold':True, 'underline':True})
        problem_format = workbook.add_format({'bg_color':'yellow'})
        
        
        worksheet.set_column('A:A',20,link_format)
        worksheet.set_column('B:B',19)
        worksheet.set_column('C:BL',30)
        """
        worksheet.conditional_format('E1:F100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '""',
                                                 'format': problem_format})
        worksheet.conditional_format('F1:F100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '"Hold for Review"',
                                                 'format': problem_format})
        worksheet.conditional_format('G1:G100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '"Needs DHCI Form"',
                                                 'format': problem_format})                                 
        worksheet.conditional_format('H1:H100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '"Needs Income Waiver"',
                                                 'format': problem_format})
        worksheet.conditional_format('I1:I100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '"Needs Substantial Activity in FY20"',
                                                 'format': problem_format})
        worksheet.conditional_format('J1:K100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '""',
                                                 'format': problem_format})
        worksheet.conditional_format('L1:L100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '"*Needs Outcome*"',
                                                 'format': problem_format})                                         
        worksheet.conditional_format('L1:L100000',{'type': 'cell',
                                                 'criteria': '==',
                                                 'value': '"*Needs Outcome Date*"',
                                                 'format': problem_format})
        """
        writer.save()
        
        return send_from_directory('sheets',output_filename, as_attachment = True, attachment_filename = "Cleaned " + f.filename)

    return '''
    <!doctype html>
    <title>IOI Immigration</title>
    <link rel="stylesheet" href="/static/css/main.css">
    <h1>Check your IOI Immigration Cases:</h1>
    <form action="" method=post enctype=multipart/form-data>
    <p><input type=file name=file><input type=submit value=IOI-ify!>
    </form>
    <h3>Instructions:</h3>
    <ul type="disc">
    <li>This tool is meant to be used in conjunction with the LegalServer report called "Grants Management IOI 2 (3459) Report".</li>
    <li>Browse your computer using the field above to find the LegalServer excel document that you want to process for IOI.</li> 
    <li>Once you have identified this file, click IOI-ify! and you should shortly be given a prompt to either open the file directly or save the file to your computer.</li> 
    <li>When you first open the file, all case numbers will display as 0 until you click Enable Editing in excel, this will populate the fields.</li> </ul>
    </br>
    <a href="/">Home</a>
    '''
